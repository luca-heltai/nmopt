{"version":3,"kind":"Notebook","sha256":"02738fa0d55428754a952f9793338dcd726ac0d7b586e3eb8096c8ddefcc94e6","slug":"finite-dim-analogy","location":"/../codes/lecture01/finite_dim_analogy.ipynb","dependencies":[],"frontmatter":{"title":"Finite-Dimensional Analogy","content_includes_title":false,"kernelspec":{"name":"python3","display_name":"base","language":"python"},"authors":[{"id":"LH","nameParsed":{"literal":"Luca Heltai","given":"Luca","family":"Heltai"},"name":"Luca Heltai","orcid":"0000-0001-5514-4683","email":"luca.heltai@unipi.it","affiliations":["unipi"],"github":"luca-heltai","linkedin":"https://www.linkedin.com/in/heltai/","youtube":"UCK0glvtKYmVPJbpurdlt9pw","corresponding":true}],"github":"https://github.com/luca-heltai/nmopt","copyright":"2025","affiliations":[{"id":"unipi","name":"University of Pisa","department":"Department of Mathematics","address":"Largo Bruno Pontecorvo 5, 56127 Pisa, Italy","city":"Pisa","postal_code":"56127","country":"Italy","ror":"https://ror.org/03ad39j10","phone":"+39 050 221 3824"}],"numbering":{"title":{"offset":1}},"source_url":"https://github.com/luca-heltai/nmopt/blob/main/codes/lecture01/finite_dim_analogy.ipynb","edit_url":"https://github.com/luca-heltai/nmopt/edit/main/codes/lecture01/finite_dim_analogy.ipynb","exports":[{"format":"ipynb","filename":"finite_dim_analogy.ipynb","url":"/nmopt//build/finite_dim_analogy-a0b85b4315cb3cf1df39a6bff2a74f64.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"This notebook illustrates the ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"gJgWrBGCBR"},{"type":"strong","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"reduced formulation","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"Hsu0qtLQS6"}],"key":"zQnRKVknNw"},{"type":"text","value":" idea on a tiny linear-quadratic problem.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"O983SHlMCL"}],"key":"SD2WBbFZ3x"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"We consider a constraint ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"qWvFGiZjb7"},{"type":"inlineMath","value":"A y = B u","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>A</mi><mi>y</mi><mo>=</mo><mi>B</mi><mi>u</mi></mrow><annotation encoding=\"application/x-tex\">A y = B u</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8778em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">A</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05017em;\">B</span><span class=\"mord mathnormal\">u</span></span></span></span>","key":"y8zDRFFRD5"},{"type":"text","value":" (invertible ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"eZkVUmLHod"},{"type":"inlineMath","value":"A","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>A</mi></mrow><annotation encoding=\"application/x-tex\">A</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\">A</span></span></span></span>","key":"N647XSZF1n"},{"type":"text","value":") and a quadratic objective","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"PCempuEnxv"}],"key":"biIxzQemCn"},{"type":"math","value":"J(y,u) = \\tfrac12\\|y - y_d\\|^2 + \\tfrac\\alpha2\\|u\\|^2.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"tight":"before","html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>J</mi><mo stretchy=\"false\">(</mo><mi>y</mi><mo separator=\"true\">,</mo><mi>u</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mstyle displaystyle=\"false\" scriptlevel=\"0\"><mfrac><mn>1</mn><mn>2</mn></mfrac></mstyle><mi mathvariant=\"normal\">∥</mi><mi>y</mi><mo>−</mo><msub><mi>y</mi><mi>d</mi></msub><msup><mi mathvariant=\"normal\">∥</mi><mn>2</mn></msup><mo>+</mo><mstyle displaystyle=\"false\" scriptlevel=\"0\"><mfrac><mi>α</mi><mn>2</mn></mfrac></mstyle><mi mathvariant=\"normal\">∥</mi><mi>u</mi><msup><mi mathvariant=\"normal\">∥</mi><mn>2</mn></msup><mi mathvariant=\"normal\">.</mi></mrow><annotation encoding=\"application/x-tex\">J(y,u) = \\tfrac12\\|y - y_d\\|^2 + \\tfrac\\alpha2\\|u\\|^2.</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.09618em;\">J</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">u</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.1901em;vertical-align:-0.345em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8451em;\"><span style=\"top:-2.655em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">2</span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.394em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.345em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mord\">∥</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.1141em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">d</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord\">∥</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8641em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.2091em;vertical-align:-0.345em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6954em;\"><span style=\"top:-2.655em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">2</span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.394em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.0037em;\">α</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.345em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mord\">∥</span><span class=\"mord mathnormal\">u</span><span class=\"mord\"><span class=\"mord\">∥</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8641em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mord\">.</span></span></span></span></span>","enumerator":"1","key":"ebOlPl7QWW"},{"type":"paragraph","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"Eliminating ","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"EixPAJUwrh"},{"type":"inlineMath","value":"y","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>y</mi></mrow><annotation encoding=\"application/x-tex\">y</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span></span></span></span>","key":"SP0CTEQP0W"},{"type":"text","value":" gives ","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"q10CXuDeL6"},{"type":"inlineMath","value":"y = S u","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>y</mi><mo>=</mo><mi>S</mi><mi>u</mi></mrow><annotation encoding=\"application/x-tex\">y = S u</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">S</span><span class=\"mord mathnormal\">u</span></span></span></span>","key":"xTULKdoHiZ"},{"type":"text","value":" with ","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"ATicdFbMhK"},{"type":"inlineMath","value":"S = A^{-1}B","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>S</mi><mo>=</mo><msup><mi>A</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mi>B</mi></mrow><annotation encoding=\"application/x-tex\">S = A^{-1}B</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">S</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8141em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">A</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">−</span><span class=\"mord mtight\">1</span></span></span></span></span></span></span></span></span><span class=\"mord mathnormal\" style=\"margin-right:0.05017em;\">B</span></span></span></span>","key":"UW2a0y15TJ"},{"type":"text","value":", hence the reduced cost ","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"GGFKNTq5Oe"},{"type":"inlineMath","value":"f(u)=J(Su,u)","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi><mo stretchy=\"false\">(</mo><mi>u</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mi>J</mi><mo stretchy=\"false\">(</mo><mi>S</mi><mi>u</mi><mo separator=\"true\">,</mo><mi>u</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">f(u)=J(Su,u)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">u</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.09618em;\">J</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">S</span><span class=\"mord mathnormal\">u</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">u</span><span class=\"mclose\">)</span></span></span></span>","key":"Vr8X7lllo2"},{"type":"text","value":".","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"QStdRt6kTj"}],"key":"ZmHfGuB3ag"}],"key":"vQ8bUvEsfj"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import numpy as np\nimport matplotlib.pyplot as plt\nfrom pathlib import Path\n\nROOT = Path.cwd().parents[1]\nOUT_DIR = ROOT / \"jupyterbook\" / \"slides\" / \"assets\" / \"lecture01\"\nOUT_DIR.mkdir(parents=True, exist_ok=True)\n\nnp.random.seed(0)","key":"lypkjpOetu"},{"type":"outputs","id":"i3DiZQyzLH10N1PHSmOTj","children":[],"key":"IFPwo8knLY"}],"key":"Bf9g1HgpOZ"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Build a Tiny Problem","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"MHa9bBcZk3"}],"identifier":"build-a-tiny-problem","label":"Build a Tiny Problem","html_id":"build-a-tiny-problem","implicit":true,"key":"IZk12cotr2"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"We’ll work with small matrices and verify that the reduced cost is convex and has a unique minimizer.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"gbmye99y7t"}],"key":"WoX1jvCk8k"}],"key":"hEmezu8Jam"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"n, m = 6, 3\nA = np.random.randn(n, n)\nA = A.T @ A + 0.5 * np.eye(n)  # SPD => invertible\nB = np.random.randn(n, m)\nalpha = 1e-2\ny_d = np.random.randn(n)\n\nS = np.linalg.solve(A, B)\n\ndef J(y, u):\n    return 0.5 * np.dot(y - y_d, y - y_d) + 0.5 * alpha * np.dot(u, u)\n\ndef f(u):\n    y = S @ u\n    return J(y, u)","key":"uP1XpkUY8a"},{"type":"outputs","id":"MCzzaKXXyOL3dLhegtrsQ","children":[],"key":"dph8yyApZP"}],"key":"bSncFUCa3W"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Closed-Form Minimizer","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"PMO4zv0FPf"}],"identifier":"closed-form-minimizer","label":"Closed-Form Minimizer","html_id":"closed-form-minimizer","implicit":true,"key":"x2YcvRFk7Q"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"For this quadratic reduced problem, the minimizer solves","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"rjKXIbMZM4"}],"key":"h0wEV6OcrW"},{"type":"math","value":"(S^T S + \\alpha I)u = S^T y_d.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"tight":"before","html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mo stretchy=\"false\">(</mo><msup><mi>S</mi><mi>T</mi></msup><mi>S</mi><mo>+</mo><mi>α</mi><mi>I</mi><mo stretchy=\"false\">)</mo><mi>u</mi><mo>=</mo><msup><mi>S</mi><mi>T</mi></msup><msub><mi>y</mi><mi>d</mi></msub><mi mathvariant=\"normal\">.</mi></mrow><annotation encoding=\"application/x-tex\">(S^T S + \\alpha I)u = S^T y_d.</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.1413em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">S</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8913em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span></span></span></span></span><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">S</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.0037em;\">α</span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">I</span><span class=\"mclose\">)</span><span class=\"mord mathnormal\">u</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0858em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">S</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8913em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">d</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\">.</span></span></span></span></span>","enumerator":"2","key":"koDFmpRQib"}],"key":"lavy9lkclt"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"H = S.T @ S + alpha * np.eye(m)\nrhs = S.T @ y_d\nu_star = np.linalg.solve(H, rhs)\ny_star = S @ u_star\n\nf_star = f(u_star)\nf_star","key":"znE2q9PVHZ"},{"type":"outputs","id":"yOGIDnaUwhqQfC-obteJ2","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":8,"metadata":{},"data":{"text/plain":{"content":"0.24237750985949655","content_type":"text/plain"}}},"children":[],"key":"MeyH39E5Zn"}],"key":"ROFNJRopul"}],"key":"AxoHblIWb7"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"A 1D Slice Plot","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"anieFg83SN"}],"identifier":"a-1d-slice-plot","label":"A 1D Slice Plot","html_id":"a-1d-slice-plot","implicit":true,"key":"WuFjCjWqqP"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Plot ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"EuO2rwC7Dt"},{"type":"inlineMath","value":"f(u_* + t d)","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi><mo stretchy=\"false\">(</mo><msub><mi>u</mi><mo>∗</mo></msub><mo>+</mo><mi>t</mi><mi>d</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">f(u_* + t d)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">u</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1757em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mbin mtight\">∗</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">t</span><span class=\"mord mathnormal\">d</span><span class=\"mclose\">)</span></span></span></span>","key":"X5rrSZSn29"},{"type":"text","value":" along a random direction ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"gGJqSCGaIC"},{"type":"inlineMath","value":"d","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>d</mi></mrow><annotation encoding=\"application/x-tex\">d</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">d</span></span></span></span>","key":"QgGtcPnX20"},{"type":"text","value":".","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"N3cbDvVPcm"}],"key":"E4LNbc99cP"}],"key":"CI8eC0rgvt"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"d = np.random.randn(m)\nd /= np.linalg.norm(d)\nt = np.linspace(-2.0, 2.0, 300)\nvals = np.array([f(u_star + ti * d) for ti in t])\n\nfig, ax = plt.subplots(figsize=(6.0, 3.5))\nax.plot(t, vals, linewidth=2)\nax.axvline(0.0, linestyle=\"--\", linewidth=1.5)\nax.set_title(\"Reduced cost along a 1D slice\")\nax.set_xlabel(\"t\")\nax.set_ylabel(r\"$f(u_* + t d)$\")\nax.grid(True, alpha=0.25)\nfig.savefig(OUT_DIR / \"reduced_cost_slice.png\", dpi=200, bbox_inches=\"tight\")\n# plt.close(fig)\n\nOUT_DIR / \"reduced_cost_slice.png\"","key":"AJJpDHrs7h"},{"type":"outputs","id":"XSX8RTZAGpSXAMUnhmtdz","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":9,"metadata":{},"data":{"text/plain":{"content":"PosixPath('/Users/heltai/latex/courses/2025/02_nmopt/jupyterbook/slides/assets/lecture01/reduced_cost_slice.png')","content_type":"text/plain"}}},"children":[],"key":"HgQiBwS8Lc"},{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"ae4c30dbf7fa53348f3a3776215c8624","path":"/nmopt//build/ae4c30dbf7fa53348f3a3776215c8624.png"},"text/plain":{"content":"<Figure size 600x350 with 1 Axes>","content_type":"text/plain"}}},"children":[],"key":"Id7lBUZy9s"}],"key":"yZGx2UHG0u"}],"key":"BRoeCnvHYg"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Constrained Minimization Example (2D)","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ZuFydO4Kbo"}],"identifier":"constrained-minimization-example-2d","label":"Constrained Minimization Example (2D)","html_id":"constrained-minimization-example-2d","implicit":true,"key":"e70KuEZyZK"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"We consider the finite-dimensional constrained problem:","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"CTF0gWxWRo"}],"key":"m1mFbCTQKJ"},{"type":"math","value":"\\min_{u\\in\\mathbb{R}^2} f(u)=\\frac12 u^T A u\n\\quad\\text{s.t.}\\quad\n\\varphi(u)=Bu-g=0,","position":{"start":{"line":5,"column":1},"end":{"line":9,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><munder><mrow><mi>min</mi><mo>⁡</mo></mrow><mrow><mi>u</mi><mo>∈</mo><msup><mi mathvariant=\"double-struck\">R</mi><mn>2</mn></msup></mrow></munder><mi>f</mi><mo stretchy=\"false\">(</mo><mi>u</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><msup><mi>u</mi><mi>T</mi></msup><mi>A</mi><mi>u</mi><mspace width=\"1em\"/><mtext>s.t.</mtext><mspace width=\"1em\"/><mi>φ</mi><mo stretchy=\"false\">(</mo><mi>u</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mi>B</mi><mi>u</mi><mo>−</mo><mi>g</mi><mo>=</mo><mn>0</mn><mo separator=\"true\">,</mo></mrow><annotation encoding=\"application/x-tex\">\\min_{u\\in\\mathbb{R}^2} f(u)=\\frac12 u^T A u\n\\quad\\text{s.t.}\\quad\n\\varphi(u)=Bu-g=0,</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.5658em;vertical-align:-0.8158em;\"></span><span class=\"mop op-limits\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6679em;\"><span style=\"top:-2.3116em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">u</span><span class=\"mrel mtight\">∈</span><span class=\"mord mtight\"><span class=\"mord mathbb mtight\">R</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7463em;\"><span style=\"top:-2.786em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span></span></span></span><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span><span class=\"mop\">min</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8158em;\"><span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">u</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.0074em;vertical-align:-0.686em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3214em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">2</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mord\"><span class=\"mord mathnormal\">u</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8913em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span></span></span></span></span><span class=\"mord mathnormal\">A</span><span class=\"mord mathnormal\">u</span><span class=\"mspace\" style=\"margin-right:1em;\"></span><span class=\"mord text\"><span class=\"mord\">s.t.</span></span><span class=\"mspace\" style=\"margin-right:1em;\"></span><span class=\"mord mathnormal\">φ</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">u</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7667em;vertical-align:-0.0833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05017em;\">B</span><span class=\"mord mathnormal\">u</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8389em;vertical-align:-0.1944em;\"></span><span class=\"mord\">0</span><span class=\"mpunct\">,</span></span></span></span></span>","enumerator":"3","key":"zY6krT1U3T"},{"type":"paragraph","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"with ","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"htxAPJUazC"},{"type":"inlineMath","value":"A","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>A</mi></mrow><annotation encoding=\"application/x-tex\">A</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\">A</span></span></span></span>","key":"coQlyPN6wf"},{"type":"text","value":" symmetric positive definite, ","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"np8hGBtQ2J"},{"type":"inlineMath","value":"B\\in\\mathbb{R}^{1\\times 2}","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>B</mi><mo>∈</mo><msup><mi mathvariant=\"double-struck\">R</mi><mrow><mn>1</mn><mo>×</mo><mn>2</mn></mrow></msup></mrow><annotation encoding=\"application/x-tex\">B\\in\\mathbb{R}^{1\\times 2}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7224em;vertical-align:-0.0391em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05017em;\">B</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">∈</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8141em;\"></span><span class=\"mord\"><span class=\"mord mathbb\">R</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">1</span><span class=\"mbin mtight\">×</span><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span></span></span></span></span>","key":"AhsTgkxwrW"},{"type":"text","value":", ","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"e6QUM1sK2M"},{"type":"inlineMath","value":"g\\in\\mathbb{R}","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>g</mi><mo>∈</mo><mi mathvariant=\"double-struck\">R</mi></mrow><annotation encoding=\"application/x-tex\">g\\in\\mathbb{R}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7335em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">∈</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6889em;\"></span><span class=\"mord mathbb\">R</span></span></span></span>","key":"pMEx6KGO2M"},{"type":"text","value":".","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"jaSNzQO30u"}],"key":"sEH3E544vL"},{"type":"paragraph","position":{"start":{"line":13,"column":1},"end":{"line":22,"column":1}},"children":[{"type":"text","value":"KKT conditions for the Lagrangian","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"BI46VQT2cA"}],"key":"f4XDMMSaMW"},{"type":"math","value":"\\mathcal{L}(u,\\lambda)=f(u)-\\lambda(Bu-g)","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"tight":true,"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi mathvariant=\"script\">L</mi><mo stretchy=\"false\">(</mo><mi>u</mi><mo separator=\"true\">,</mo><mi>λ</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mi>f</mi><mo stretchy=\"false\">(</mo><mi>u</mi><mo stretchy=\"false\">)</mo><mo>−</mo><mi>λ</mi><mo stretchy=\"false\">(</mo><mi>B</mi><mi>u</mi><mo>−</mo><mi>g</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">\\mathcal{L}(u,\\lambda)=f(u)-\\lambda(Bu-g)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathcal\">L</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">u</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">λ</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">u</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">λ</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.05017em;\">B</span><span class=\"mord mathnormal\">u</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mclose\">)</span></span></span></span></span>","enumerator":"4","key":"lU1ldj4xL0"},{"type":"paragraph","position":{"start":{"line":13,"column":1},"end":{"line":22,"column":1}},"children":[{"type":"text","value":"are","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"F0kfK4oA7M"}],"key":"pXoINUHas6"},{"type":"math","value":"Au-B^T\\lambda=0,\\qquad Bu-g=0,","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"tight":true,"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>A</mi><mi>u</mi><mo>−</mo><msup><mi>B</mi><mi>T</mi></msup><mi>λ</mi><mo>=</mo><mn>0</mn><mo separator=\"true\">,</mo><mspace width=\"2em\"/><mi>B</mi><mi>u</mi><mo>−</mo><mi>g</mi><mo>=</mo><mn>0</mn><mo separator=\"true\">,</mo></mrow><annotation encoding=\"application/x-tex\">Au-B^T\\lambda=0,\\qquad Bu-g=0,</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7667em;vertical-align:-0.0833em;\"></span><span class=\"mord mathnormal\">A</span><span class=\"mord mathnormal\">u</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8913em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.05017em;\">B</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8913em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span></span></span></span></span><span class=\"mord mathnormal\">λ</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8778em;vertical-align:-0.1944em;\"></span><span class=\"mord\">0</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:2em;\"></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05017em;\">B</span><span class=\"mord mathnormal\">u</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8389em;vertical-align:-0.1944em;\"></span><span class=\"mord\">0</span><span class=\"mpunct\">,</span></span></span></span></span>","enumerator":"5","key":"GFwYQRJPFB"},{"type":"paragraph","position":{"start":{"line":13,"column":1},"end":{"line":22,"column":1}},"children":[{"type":"text","value":"which gives the linear saddle-point system\n$$","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"FZno3MjUCs"}],"key":"ET3JP11XS1"},{"type":"math","value":"\\begin{pmatrix}\nA & -B^T\\\\\n-B & 0\n\\end{pmatrix}","tight":true,"position":{"start":{"line":23,"column":1},"end":{"line":25,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mo fence=\"true\">(</mo><mtable rowspacing=\"0.16em\" columnalign=\"center center\" columnspacing=\"1em\"><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mi>A</mi></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><mo>−</mo><msup><mi>B</mi><mi>T</mi></msup></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><mo>−</mo><mi>B</mi></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>0</mn></mstyle></mtd></mtr></mtable><mo fence=\"true\">)</mo></mrow><annotation encoding=\"application/x-tex\">\\begin{pmatrix}\nA &amp; -B^T\\\\\n-B &amp; 0\n\\end{pmatrix}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:2.4013em;vertical-align:-0.9507em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size3\">(</span></span><span class=\"mord\"><span class=\"mtable\"><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.4507em;\"><span style=\"top:-3.6093em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">A</span></span></span><span style=\"top:-2.4093em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">−</span><span class=\"mord mathnormal\" style=\"margin-right:0.05017em;\">B</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9507em;\"><span></span></span></span></span></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.4507em;\"><span style=\"top:-3.6093em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">−</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.05017em;\">B</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8413em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span></span></span></span></span></span></span><span style=\"top:-2.4093em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">0</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9507em;\"><span></span></span></span></span></span></span></span><span class=\"mclose delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size3\">)</span></span></span></span></span></span></span>","enumerator":"6","key":"rZtyRN06wX"},{"type":"math","value":"\\begin{pmatrix}\nu\\\\\\lambda\\end{pmatrix}","tight":true,"position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mo fence=\"true\">(</mo><mtable rowspacing=\"0.16em\" columnalign=\"center\" columnspacing=\"1em\"><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mi>u</mi></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mi>λ</mi></mstyle></mtd></mtr></mtable><mo fence=\"true\">)</mo></mrow><annotation encoding=\"application/x-tex\">\\begin{pmatrix}\nu\\\\\\lambda\\end{pmatrix}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:2.4em;vertical-align:-0.95em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size3\">(</span></span><span class=\"mord\"><span class=\"mtable\"><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.45em;\"><span style=\"top:-3.61em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">u</span></span></span><span style=\"top:-2.41em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">λ</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.95em;\"><span></span></span></span></span></span></span></span><span class=\"mclose delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size3\">)</span></span></span></span></span></span></span>","enumerator":"7","key":"Bg8GUlNdX4"},{"type":"paragraph","position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"children":[{"type":"text","value":"=","position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"key":"ShTgArquTR"}],"key":"z8C1MVlDcR"},{"type":"math","value":"\\begin{pmatrix}0\\\\-g\\end{pmatrix}","tight":true,"position":{"start":{"line":30,"column":1},"end":{"line":29,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mo fence=\"true\">(</mo><mtable rowspacing=\"0.16em\" columnalign=\"center\" columnspacing=\"1em\"><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>0</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><mo>−</mo><mi>g</mi></mrow></mstyle></mtd></mtr></mtable><mo fence=\"true\">)</mo></mrow><annotation encoding=\"application/x-tex\">\\begin{pmatrix}0\\\\-g\\end{pmatrix}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:2.4em;vertical-align:-0.95em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size3\">(</span></span><span class=\"mord\"><span class=\"mtable\"><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.45em;\"><span style=\"top:-3.61em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">0</span></span></span><span style=\"top:-2.41em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">−</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.95em;\"><span></span></span></span></span></span></span></span><span class=\"mclose delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size3\">)</span></span></span></span></span></span></span>","enumerator":"8","key":"ttg8RgqkXr"},{"type":"paragraph","position":{"start":{"line":31,"column":1},"end":{"line":31,"column":1}},"children":[{"type":"text","value":"$$","position":{"start":{"line":31,"column":1},"end":{"line":31,"column":1}},"key":"XBA8poauE1"}],"key":"PqYasCjtHo"}],"key":"CGh4OLI4KG"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# 2D constrained minimization: geometry + 1D feasible restriction\nA2 = np.array([[3.0, 1.0], [1.0, 2.0]], dtype=float)\nB2 = np.array([[1.0, -1.0]], dtype=float)\ng2 = np.array([0.5], dtype=float)\n\nkkt = np.block([[A2, -B2.T], [-B2, np.zeros((1, 1))]])\nrhs = np.concatenate([np.zeros(2), -g2])\nsol = np.linalg.solve(kkt, rhs)\nu2_star = sol[:2]\nlambda2_star = sol[2]\n\nprint('u* =', u2_star)\nprint('lambda* =', lambda2_star)\n\n# Contours of f(u) and constraint line Bu=g\nu1 = np.linspace(-1.2, 1.8, 400)\nu2 = np.linspace(-1.2, 1.8, 400)\nU1, U2 = np.meshgrid(u1, u2)\nF2 = 0.5 * (A2[0, 0] * U1**2 + 2.0 * A2[0, 1] * U1 * U2 + A2[1, 1] * U2**2)\n\nfig, ax = plt.subplots(figsize=(6.2, 4.6))\nlevels = np.linspace(0.1, 4.0, 9)\nax.contour(U1, U2, F2, levels=levels, cmap='Greens', linewidths=1.5)\n\nline_u1 = np.array([u1.min(), u1.max()])\nline_u2 = line_u1 - g2[0]  # u2 = u1 - g\nax.plot(line_u1, line_u2, color='purple', linewidth=2.2, label=r'$\\varphi(u)=Bu-g=0$')\n\nax.scatter(u2_star[0], u2_star[1], color='navy', s=50, zorder=5)\nax.text(u2_star[0] + 0.05, u2_star[1] + 0.03, r'$u^\\star$', color='navy')\n\ngrad_f = A2 @ u2_star\ngrad_phi = B2.ravel()\nscale = 0.28\nax.arrow(u2_star[0], u2_star[1], scale * grad_f[0], scale * grad_f[1],\n         width=0.004, head_width=0.05, color='tab:red', length_includes_head=True)\nax.text(u2_star[0] + scale * grad_f[0] + 0.03,\n        u2_star[1] + scale * grad_f[1] + 0.02,\n        r'$\\nabla f(u^\\star)$', color='tab:red')\n\nax.arrow(u2_star[0], u2_star[1], scale * grad_phi[0], scale * grad_phi[1],\n         width=0.004, head_width=0.05, color='tab:blue', length_includes_head=True)\nax.text(u2_star[0] + scale * grad_phi[0] + 0.03,\n        u2_star[1] + scale * grad_phi[1] + 0.02,\n        r'$\\nabla \\varphi$', color='tab:blue')\n\nax.set_title('2D constrained minimization: geometry')\nax.set_xlabel(r'$u_1$')\nax.set_ylabel(r'$u_2$')\nax.set_aspect('equal', adjustable='box')\nax.set_xlim(u1.min(), u1.max())\nax.set_ylim(u2.min(), u2.max())\nax.grid(True, alpha=0.25)\nax.legend(loc='upper left')\nfig.savefig(OUT_DIR / 'minimization_geometry.png', dpi=200, bbox_inches='tight')\n\n# Restrict to the feasible line u(t)=u0+t d where B d = 0\nu0 = np.array([g2[0], 0.0])\nd = np.array([1.0, 1.0])\nt = np.linspace(-1.5, 1.5, 300)\nUline = u0[None, :] + t[:, None] * d[None, :]\nvals_line = 0.5 * np.einsum('bi,ij,bj->b', Uline, A2, Uline)\n\nt_star = t[np.argmin(vals_line)]\n\nfig, ax = plt.subplots(figsize=(6.0, 3.6))\nax.plot(t, vals_line, linewidth=2.0)\nax.axvline(t_star, linestyle='--', linewidth=1.5)\nax.set_title(r'$f(u(t))$ on the constraint $\\varphi(u)=0$')\nax.set_xlabel(r'$t$ (feasible direction parameter)')\nax.set_ylabel(r'$f(u(t))$')\nax.grid(True, alpha=0.25)\nax.text(t_star + 0.04, float(np.min(vals_line)) + 0.03, rf'$t^\\star \\approx {t_star:.3f}$', fontsize=10)\nfig.savefig(OUT_DIR / 'minimization_on_constraint.png', dpi=200, bbox_inches='tight')\n\nOUT_DIR / 'minimization_geometry.png', OUT_DIR / 'minimization_on_constraint.png'","key":"MdVpLuh6rV"},{"type":"outputs","id":"Gi6p5eBdQDIAQ1cwD_Vhk","children":[],"key":"zkIcXQWzut"}],"key":"ZSqbnRYs8u"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"What Changes for PDEs","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"uap7IMvKwt"}],"identifier":"what-changes-for-pdes","label":"What Changes for PDEs","html_id":"what-changes-for-pdes","implicit":true,"key":"Drs6Lwkz4r"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":3,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"paragraph","children":[{"type":"inlineMath","value":"S","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>S</mi></mrow><annotation encoding=\"application/x-tex\">S</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">S</span></span></span></span>","key":"uHzAdJb2JK"},{"type":"text","value":" becomes the solution operator of a PDE (still linear in LQ elliptic problems).","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"aO1Uol8LLw"}],"key":"UTiPhW11gY"}],"key":"sEdiY9imPT"},{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Gradients are computed efficiently via adjoints (no explicit ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"trhk5ImrrJ"},{"type":"inlineMath","value":"S","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>S</mi></mrow><annotation encoding=\"application/x-tex\">S</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">S</span></span></span></span>","key":"vMNtMtpjgU"},{"type":"text","value":" matrix).","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"jgQDHKYnAT"}],"key":"S4yOdP9XFi"}],"key":"OETYHYLgZV"}],"key":"Q0N6XK00Jn"}],"key":"XTScTnR18K"}],"key":"aVVwbbMXeC"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Introduction and Motivation for PDE-Constrained Optimal Control","url":"/lectures/lecture01","group":"Lectures"},"next":{"title":"Introduction & Motivation","url":"/slides/slides01","group":"Slides"}}},"domain":"http://localhost:3000"}