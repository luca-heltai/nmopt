{"version":"1","records":[{"hierarchy":{"lvl1":"Finite-Dimensional Analogy"},"type":"lvl1","url":"/finite-dim-analogy","position":0},{"hierarchy":{"lvl1":"Finite-Dimensional Analogy"},"content":"This notebook illustrates the reduced formulation idea on a tiny linear-quadratic problem.\n\nWe consider a constraint A y = B u (invertible A) and a quadratic objectiveJ(y,u) = \\tfrac12\\|y - y_d\\|^2 + \\tfrac\\alpha2\\|u\\|^2.\n\nEliminating y gives y = S u with S = A^{-1}B, hence the reduced cost f(u)=J(Su,u).\n\nimport numpy as np\nimport matplotlib.pyplot as plt\nfrom pathlib import Path\n\nROOT = Path.cwd().parents[1]\nOUT_DIR = ROOT / \"jupyterbook\" / \"slides\" / \"assets\"\nOUT_DIR.mkdir(parents=True, exist_ok=True)\n\nnp.random.seed(0)\n\n\n\n","type":"content","url":"/finite-dim-analogy","position":1},{"hierarchy":{"lvl1":"Finite-Dimensional Analogy","lvl2":"Build a Tiny Problem"},"type":"lvl2","url":"/finite-dim-analogy#build-a-tiny-problem","position":2},{"hierarchy":{"lvl1":"Finite-Dimensional Analogy","lvl2":"Build a Tiny Problem"},"content":"We‚Äôll work with small matrices and verify that the reduced cost is convex and has a unique minimizer.\n\nn, m = 6, 3\nA = np.random.randn(n, n)\nA = A.T @ A + 0.5 * np.eye(n)  # SPD => invertible\nB = np.random.randn(n, m)\nalpha = 1e-2\ny_d = np.random.randn(n)\n\nS = np.linalg.solve(A, B)\n\ndef J(y, u):\n    return 0.5 * np.dot(y - y_d, y - y_d) + 0.5 * alpha * np.dot(u, u)\n\ndef f(u):\n    y = S @ u\n    return J(y, u)\n\n\n\n","type":"content","url":"/finite-dim-analogy#build-a-tiny-problem","position":3},{"hierarchy":{"lvl1":"Finite-Dimensional Analogy","lvl2":"Closed-Form Minimizer"},"type":"lvl2","url":"/finite-dim-analogy#closed-form-minimizer","position":4},{"hierarchy":{"lvl1":"Finite-Dimensional Analogy","lvl2":"Closed-Form Minimizer"},"content":"For this quadratic reduced problem, the minimizer solves(S^T S + \\alpha I)u = S^T y_d.\n\nH = S.T @ S + alpha * np.eye(m)\nrhs = S.T @ y_d\nu_star = np.linalg.solve(H, rhs)\ny_star = S @ u_star\n\nf_star = f(u_star)\nf_star\n\n\n\n","type":"content","url":"/finite-dim-analogy#closed-form-minimizer","position":5},{"hierarchy":{"lvl1":"Finite-Dimensional Analogy","lvl2":"A 1D Slice Plot"},"type":"lvl2","url":"/finite-dim-analogy#a-1d-slice-plot","position":6},{"hierarchy":{"lvl1":"Finite-Dimensional Analogy","lvl2":"A 1D Slice Plot"},"content":"Plot f(u_* + t d) along a random direction d.\n\nd = np.random.randn(m)\nd /= np.linalg.norm(d)\nt = np.linspace(-2.0, 2.0, 300)\nvals = np.array([f(u_star + ti * d) for ti in t])\n\nfig, ax = plt.subplots(figsize=(6.0, 3.5))\nax.plot(t, vals, linewidth=2)\nax.axvline(0.0, linestyle=\"--\", linewidth=1.5)\nax.set_title(\"Reduced cost along a 1D slice\")\nax.set_xlabel(\"t\")\nax.set_ylabel(r\"$f(u_* + t d)$\")\nax.grid(True, alpha=0.25)\nfig.savefig(OUT_DIR / \"01_reduced_cost_slice.png\", dpi=200, bbox_inches=\"tight\")\n# plt.close(fig)\n\nOUT_DIR / \"01_reduced_cost_slice.png\"\n\n\n\n\n\n","type":"content","url":"/finite-dim-analogy#a-1d-slice-plot","position":7},{"hierarchy":{"lvl1":"Finite-Dimensional Analogy","lvl2":"Constrained Minimization Example (2D)"},"type":"lvl2","url":"/finite-dim-analogy#constrained-minimization-example-2d","position":8},{"hierarchy":{"lvl1":"Finite-Dimensional Analogy","lvl2":"Constrained Minimization Example (2D)"},"content":"We consider the finite-dimensional constrained problem:\\min_{u\\in\\mathbb{R}^2} f(u)=\\frac12 u^T A u\n\\quad\\text{s.t.}\\quad\n\\varphi(u)=Bu-g=0,\n\nwith A symmetric positive definite, B\\in\\mathbb{R}^{1\\times 2}, g\\in\\mathbb{R}.\n\nKKT conditions for the Lagrangian\\mathcal{L}(u,\\lambda)=f(u)-\\lambda(Bu-g)\n\nareAu-B^T\\lambda=0,\\qquad Bu-g=0,\n\nwhich gives the linear saddle-point system\\begin{pmatrix} A & -B^T\\\\\\ -B & 0\\end{pmatrix}\\begin{pmatrix}u\\\\\\ \\lambda\\end{pmatrix}=\\begin{pmatrix}0\\\\-g\\end{pmatrix}.\n\n# 2D constrained minimization: geometry + 1D feasible restriction\nA2 = np.array([[3.0, 1.0], [1.0, 2.0]], dtype=float)\nB2 = np.array([[1.0, -1.0]], dtype=float)\ng2 = np.array([0.5], dtype=float)\n\nkkt = np.block([[A2, -B2.T], [-B2, np.zeros((1, 1))]])\nrhs = np.concatenate([np.zeros(2), -g2])\nsol = np.linalg.solve(kkt, rhs)\nu2_star = sol[:2]\nlambda2_star = sol[2]\n\nprint('u* =', u2_star)\nprint('lambda* =', lambda2_star)\n\n# Contours of f(u) and constraint line Bu=g\nu1 = np.linspace(-1.2, 1.8, 400)\nu2 = np.linspace(-1.2, 1.8, 400)\nU1, U2 = np.meshgrid(u1, u2)\nF2 = 0.5 * (A2[0, 0] * U1**2 + 2.0 * A2[0, 1] * U1 * U2 + A2[1, 1] * U2**2)\n\nfig, ax = plt.subplots(figsize=(6.2, 4.6))\nlevels = np.linspace(0.1, 4.0, 9)\nax.contour(U1, U2, F2, levels=levels, cmap='Greens', linewidths=1.5)\n\nline_u1 = np.array([u1.min(), u1.max()])\nline_u2 = line_u1 - g2[0]  # u2 = u1 - g\nax.plot(line_u1, line_u2, color='purple', linewidth=2.2, label=r'$\\varphi(u)=Bu-g=0$')\n\nax.scatter(u2_star[0], u2_star[1], color='navy', s=50, zorder=5)\nax.text(u2_star[0] + 0.05, u2_star[1] + 0.03, r'$u^\\star$', color='navy')\n\ngrad_f = A2 @ u2_star\ngrad_phi = B2.ravel()\nscale = 0.28\nax.arrow(u2_star[0], u2_star[1], scale * grad_f[0], scale * grad_f[1],\n         width=0.004, head_width=0.05, color='tab:red', length_includes_head=True)\nax.text(u2_star[0] + scale * grad_f[0] + 0.03,\n        u2_star[1] + scale * grad_f[1] + 0.02,\n        r'$\\nabla f(u^\\star)$', color='tab:red')\n\nax.arrow(u2_star[0], u2_star[1], scale * grad_phi[0], scale * grad_phi[1],\n         width=0.004, head_width=0.05, color='tab:blue', length_includes_head=True)\nax.text(u2_star[0] + scale * grad_phi[0] + 0.03,\n        u2_star[1] + scale * grad_phi[1] + 0.02,\n        r'$\\nabla \\varphi$', color='tab:blue')\n\nax.set_title('2D constrained minimization: geometry')\nax.set_xlabel(r'$u_1$')\nax.set_ylabel(r'$u_2$')\nax.set_aspect('equal', adjustable='box')\nax.set_xlim(u1.min(), u1.max())\nax.set_ylim(u2.min(), u2.max())\nax.grid(True, alpha=0.25)\nax.legend(loc='upper left')\nfig.savefig(OUT_DIR / '01_minimization_geometry.png', dpi=200, bbox_inches='tight')\n\n# Restrict to the feasible line u(t)=u0+t d where B d = 0\nu0 = np.array([g2[0], 0.0])\nd = np.array([1.0, 1.0])\nt = np.linspace(-1.5, 1.5, 300)\nUline = u0[None, :] + t[:, None] * d[None, :]\nvals_line = 0.5 * np.einsum('bi,ij,bj->b', Uline, A2, Uline)\n\nt_star = t[np.argmin(vals_line)]\n\nfig, ax = plt.subplots(figsize=(6.0, 3.6))\nax.plot(t, vals_line, linewidth=2.0)\nax.axvline(t_star, linestyle='--', linewidth=1.5)\nax.set_title(r'$f(u(t))$ on the constraint $\\varphi(u)=0$')\nax.set_xlabel(r'$t$ (feasible direction parameter)')\nax.set_ylabel(r'$f(u(t))$')\nax.grid(True, alpha=0.25)\nax.text(t_star + 0.04, float(np.min(vals_line)) + 0.03, rf'$t^\\star \\approx {t_star:.3f}$', fontsize=10)\nfig.savefig(OUT_DIR / '01_minimization_on_constraint.png', dpi=200, bbox_inches='tight')\n\nOUT_DIR / '01_minimization_geometry.png', OUT_DIR / '01_minimization_on_constraint.png'\n\n\n\n","type":"content","url":"/finite-dim-analogy#constrained-minimization-example-2d","position":9},{"hierarchy":{"lvl1":"Finite-Dimensional Analogy","lvl2":"What Changes for PDEs (Hilbert setting)"},"type":"lvl2","url":"/finite-dim-analogy#what-changes-for-pdes-hilbert-setting","position":10},{"hierarchy":{"lvl1":"Finite-Dimensional Analogy","lvl2":"What Changes for PDEs (Hilbert setting)"},"content":"S becomes the solution operator of a PDE (still linear in LQ elliptic problems).\n\nGradients are computed efficiently via adjoints (no explicit S matrix).\n\nThe definition of gradients and Hessians passes through the Riesz map, which depends on the choice of inner product in the control space.","type":"content","url":"/finite-dim-analogy#what-changes-for-pdes-hilbert-setting","position":11},{"hierarchy":{"lvl1":"Numerical Methods for Optimal Control"},"type":"lvl1","url":"/","position":0},{"hierarchy":{"lvl1":"Numerical Methods for Optimal Control"},"content":"","type":"content","url":"/","position":1},{"hierarchy":{"lvl1":"Numerical Methods for Optimal Control","lvl2":"Course Objectives"},"type":"lvl2","url":"/#course-objectives","position":2},{"hierarchy":{"lvl1":"Numerical Methods for Optimal Control","lvl2":"Course Objectives"},"content":"The course introduces the mathematical theory and numerical methods for PDE-constrained optimal control problems.The focus is on:\n\nrigorous formulation of optimal control problems governed by PDEs;\n\nderivation of first-order (and selected second-order) optimality conditions;\n\nfinite element discretization of optimal control problems;\n\nimplementation of numerical algorithms using deal.II.\n\nAt the end of the course, students will be able to develop and analyze research-level prototype codes for PDE-constrained optimization.","type":"content","url":"/#course-objectives","position":3},{"hierarchy":{"lvl1":"Numerical Methods for Optimal Control","lvl2":"Prerequisites"},"type":"lvl2","url":"/#prerequisites","position":4},{"hierarchy":{"lvl1":"Numerical Methods for Optimal Control","lvl2":"Prerequisites"},"content":"Advanced calculus\n\nPartial differential equations (elliptic and parabolic)\n\nNumerical methods for PDEs (finite element methods)\n\nProgramming in C++ and Python is helpful for the laboratories, but not required for the lectures\n\nBasic familiarity with Linux and scientific software tools.\n\nPrevious experience with deal.II is helpful but not mandatory.","type":"content","url":"/#prerequisites","position":5},{"hierarchy":{"lvl1":"Numerical Methods for Optimal Control","lvl2":"Numerical Laboratories (deal.II, Python)"},"type":"lvl2","url":"/#numerical-laboratories-deal-ii-python","position":6},{"hierarchy":{"lvl1":"Numerical Methods for Optimal Control","lvl2":"Numerical Laboratories (deal.II, Python)"},"content":"The laboratories are an integral part of the course and include:\n\ndistributed control of the Poisson equation;\n\nstate‚Äìadjoint formulation and reduced gradient methods;\n\nbox constraints on the control (projection methods, PDAS);\n\ntime-dependent optimal control problems;\n\nanalysis of computational performance and scalability.\n\nThe codes:\n\nare written in C++ and Python;\n\nare based on deal.II\n\nare designed as starting points for extensions and final projects\n\nwill be provided with detailed documentation and comments for you to understand and modify.","type":"content","url":"/#numerical-laboratories-deal-ii-python","position":7},{"hierarchy":{"lvl1":"Numerical Methods for Optimal Control","lvl2":"References"},"type":"lvl2","url":"/#references","position":8},{"hierarchy":{"lvl1":"Numerical Methods for Optimal Control","lvl2":"References"},"content":"F. Tr√∂ltzsch, Optimal Control of Partial Differential Equations, AMS, 2010\n\nA. Manzoni, A. Quarteroni, S. Salsa, Optimal Control of Partial Differential Equations, Springer, 2021\n\nJ. C. De los Reyes, Numerical PDE-Constrained Optimization, Springer, 2015\n\nAdditional references are provided within the individual chapters.","type":"content","url":"/#references","position":9},{"hierarchy":{"lvl1":"Numerical Methods for Optimal Control","lvl2":"License"},"type":"lvl2","url":"/#license","position":10},{"hierarchy":{"lvl1":"Numerical Methods for Optimal Control","lvl2":"License"},"content":"The content of this repository is licensed under the MIT License. See the \n\nLICENSE file for details.\n\nUse the table of contents to navigate the 20 sessions (each ~2h).\n\nCourse at a Glance\n\nFormat: 20 sessions (~2h each), lectures + laboratories.\n\nStructure: 3 blocks (Foundations -> Numerics -> Nonlinear/advanced topics).\n\nQuick links: \n\nLecture 01, \n\nSlides 01.","type":"content","url":"/#license","position":11},{"hierarchy":{"lvl1":"Numerical Methods for Optimal Control","lvl2":"Course Topic Summary"},"type":"lvl2","url":"/#course-topic-summary","position":12},{"hierarchy":{"lvl1":"Numerical Methods for Optimal Control","lvl2":"Course Topic Summary"},"content":"The course is organized into three main blocks, progressing from foundational concepts to advanced numerical methods and applications. The emphasis is on PDE-constrained optimal control, with systematic integration of theory and numerical implementation.","type":"content","url":"/#course-topic-summary","position":13},{"hierarchy":{"lvl1":"Numerical Methods for Optimal Control","lvl3":"Block I: Foundations and Linear Elliptic Optimal Control (Lectures 1-6)","lvl2":"Course Topic Summary"},"type":"lvl3","url":"/#block-i-foundations-and-linear-elliptic-optimal-control-lectures-1-6","position":14},{"hierarchy":{"lvl1":"Numerical Methods for Optimal Control","lvl3":"Block I: Foundations and Linear Elliptic Optimal Control (Lectures 1-6)","lvl2":"Course Topic Summary"},"content":"This block introduces the mathematical framework of optimal control problems governed by PDEs, with a focus on linear-quadratic elliptic problems.","type":"content","url":"/#block-i-foundations-and-linear-elliptic-optimal-control-lectures-1-6","position":15},{"hierarchy":{"lvl1":"Numerical Methods for Optimal Control","lvl4":"Topics","lvl3":"Block I: Foundations and Linear Elliptic Optimal Control (Lectures 1-6)","lvl2":"Course Topic Summary"},"type":"lvl4","url":"/#topics","position":16},{"hierarchy":{"lvl1":"Numerical Methods for Optimal Control","lvl4":"Topics","lvl3":"Block I: Foundations and Linear Elliptic Optimal Control (Lectures 1-6)","lvl2":"Course Topic Summary"},"content":"Introduction to optimal control problems: motivation, examples, and applications.\n\nAbstract formulation of PDE-constrained optimization problems.\n\nControl-to-state mapping and reduced cost functional.\n\nAdjoint equations and reduced gradients.\n\nLinear-quadratic optimal control of elliptic PDEs.\n\nDistributed and boundary controls.\n\nExistence and uniqueness of optimal controls.\n\nControl constraints and Karush-Kuhn-Tucker (KKT) conditions.\n\nConceptual introduction to numerical discretization strategies: optimize-then-discretize vs discretize-then-optimize.\n\nBy the end of this block, students understand the continuous optimality system and its analytical properties.","type":"content","url":"/#topics","position":17},{"hierarchy":{"lvl1":"Numerical Methods for Optimal Control","lvl3":"Block II: Numerical Approximation and Parabolic Optimal Control (Lectures 7-12)","lvl2":"Course Topic Summary"},"type":"lvl3","url":"/#block-ii-numerical-approximation-and-parabolic-optimal-control-lectures-7-12","position":18},{"hierarchy":{"lvl1":"Numerical Methods for Optimal Control","lvl3":"Block II: Numerical Approximation and Parabolic Optimal Control (Lectures 7-12)","lvl2":"Course Topic Summary"},"content":"This block focuses on the numerical solution of optimal control problems and extends the theory to time-dependent (parabolic) PDEs.","type":"content","url":"/#block-ii-numerical-approximation-and-parabolic-optimal-control-lectures-7-12","position":19},{"hierarchy":{"lvl1":"Numerical Methods for Optimal Control","lvl4":"Topics","lvl3":"Block II: Numerical Approximation and Parabolic Optimal Control (Lectures 7-12)","lvl2":"Course Topic Summary"},"type":"lvl4","url":"/#topics-1","position":20},{"hierarchy":{"lvl1":"Numerical Methods for Optimal Control","lvl4":"Topics","lvl3":"Block II: Numerical Approximation and Parabolic Optimal Control (Lectures 7-12)","lvl2":"Course Topic Summary"},"content":"Finite element discretization of elliptic optimal control problems.\n\nReduced vs all-at-once formulations.\n\nSaddle-point systems and block structure.\n\nIterative solvers and preconditioning strategies.\n\nNumerical treatment of control constraints.\n\nLinear-quadratic optimal control of parabolic PDEs.\n\nAdjoint equations backward in time.\n\nSpace-time discretization strategies.\n\nNumerical algorithms for time-dependent optimal control problems.\n\nComputational aspects and scalability considerations.\n\nLaboratories in this block introduce deal.II-based implementations for elliptic and parabolic problems.","type":"content","url":"/#topics-1","position":21},{"hierarchy":{"lvl1":"Numerical Methods for Optimal Control","lvl3":"Block III: Nonlinear Problems and Advanced Topics (Lectures 13-20)","lvl2":"Course Topic Summary"},"type":"lvl3","url":"/#block-iii-nonlinear-problems-and-advanced-topics-lectures-13-20","position":22},{"hierarchy":{"lvl1":"Numerical Methods for Optimal Control","lvl3":"Block III: Nonlinear Problems and Advanced Topics (Lectures 13-20)","lvl2":"Course Topic Summary"},"content":"The final block addresses nonlinear and nonsmooth optimal control problems, together with advanced numerical algorithms and applications.","type":"content","url":"/#block-iii-nonlinear-problems-and-advanced-topics-lectures-13-20","position":23},{"hierarchy":{"lvl1":"Numerical Methods for Optimal Control","lvl4":"Topics","lvl3":"Block III: Nonlinear Problems and Advanced Topics (Lectures 13-20)","lvl2":"Course Topic Summary"},"type":"lvl4","url":"/#topics-2","position":24},{"hierarchy":{"lvl1":"Numerical Methods for Optimal Control","lvl4":"Topics","lvl3":"Block III: Nonlinear Problems and Advanced Topics (Lectures 13-20)","lvl2":"Course Topic Summary"},"content":"Optimal control problems governed by semilinear PDEs.\n\nOptimization in Banach spaces.\n\nFirst-order optimality conditions for nonlinear problems.\n\nSecond-order optimality conditions and stability.\n\nNewton and Sequential Quadratic Programming (SQP) methods.\n\nPrimal-Dual Active Set (PDAS) methods and semismooth Newton methods.\n\nNonsmooth problems: box constraints, sparsity-promoting costs.\n\nSelected advanced applications (e.g., flow control, parameter identification).\n\nDiscussion of current research directions in PDE-constrained optimization.\n\nThis block prepares students to read current research literature and develop research-level numerical codes.","type":"content","url":"/#topics-2","position":25},{"hierarchy":{"lvl1":"Numerical Methods for Optimal Control","lvl3":"Overall Learning Trajectory","lvl2":"Course Topic Summary"},"type":"lvl3","url":"/#overall-learning-trajectory","position":26},{"hierarchy":{"lvl1":"Numerical Methods for Optimal Control","lvl3":"Overall Learning Trajectory","lvl2":"Course Topic Summary"},"content":"The course progresses along the following axis:\n\ncontinuous theory -> discrete formulations -> algorithms -> implementation -> applications\n\nBy the end of the course, students have:\n\nA solid theoretical understanding of PDE-constrained optimal control.\n\nPractical experience with finite element implementations in deal.II.\n\nThe ability to critically assess numerical methods and modeling choices.","type":"content","url":"/#overall-learning-trajectory","position":27},{"hierarchy":{"lvl1":"Introduction and Motivation for PDE-Constrained Optimal Control"},"type":"lvl1","url":"/lectures/lecture01","position":0},{"hierarchy":{"lvl1":"Introduction and Motivation for PDE-Constrained Optimal Control"},"content":"","type":"content","url":"/lectures/lecture01","position":1},{"hierarchy":{"lvl1":"Introduction and Motivation for PDE-Constrained Optimal Control","lvl2":"Overview"},"type":"lvl2","url":"/lectures/lecture01#overview","position":2},{"hierarchy":{"lvl1":"Introduction and Motivation for PDE-Constrained Optimal Control","lvl2":"Overview"},"content":"This lecture introduces optimal control as an optimization problem constrained by equations.\nWe first build the finite-dimensional analogy, then move to PDE-constrained models.\n\nLogical path of the lecture:\n\nstart from a constrained optimization problem in (y,u);\n\neliminate the state through the model equation when possible;\n\nobtain a reduced optimization problem in the control variable only;\n\nderive first-order conditions in finite dimension;\n\ntransfer the same structure to PDE settings.","type":"content","url":"/lectures/lecture01#overview","position":3},{"hierarchy":{"lvl1":"Introduction and Motivation for PDE-Constrained Optimal Control","lvl2":"1. General Optimal Control Problem"},"type":"lvl2","url":"/lectures/lecture01#id-1-general-optimal-control-problem","position":4},{"hierarchy":{"lvl1":"Introduction and Motivation for PDE-Constrained Optimal Control","lvl2":"1. General Optimal Control Problem"},"content":"Choose a control variable u and a state variable y such that(y^\\star,u^\\star)\\in\\operatorname*{argmin}_{(y,u)} J(y,u)\n\nsubject to\\mathcal{E}(y,u)=0,\\qquad u\\in\\mathcal{U}_{\\mathrm{ad}}.\n\nKey ingredients:\n\nstate equation \\mathcal{E}(y,u)=0 (ODE/PDE/algebraic)\n\nadmissible controls u\\in\\mathcal{U}_{\\mathrm{ad}}\n\ncost functional J(y,u)\n\noptional extra constraints (box constraints, state constraints, etc.)","type":"content","url":"/lectures/lecture01#id-1-general-optimal-control-problem","position":5},{"hierarchy":{"lvl1":"Introduction and Motivation for PDE-Constrained Optimal Control","lvl2":"2. Forward Problem vs Control Problem"},"type":"lvl2","url":"/lectures/lecture01#id-2-forward-problem-vs-control-problem","position":6},{"hierarchy":{"lvl1":"Introduction and Motivation for PDE-Constrained Optimal Control","lvl2":"2. Forward Problem vs Control Problem"},"content":"Forward problem:\n\ndata are fixed\n\nsolve once for y\n\nOptimal control:\n\nu is unknown\n\nsolve the state equation repeatedly inside optimization\n\nKey point\n\nIn optimal control, the PDE is a constraint, not the objective.","type":"content","url":"/lectures/lecture01#id-2-forward-problem-vs-control-problem","position":7},{"hierarchy":{"lvl1":"Introduction and Motivation for PDE-Constrained Optimal Control","lvl2":"3. Finite-Dimensional Setting (Simultaneous vs Reduced)"},"type":"lvl2","url":"/lectures/lecture01#id-3-finite-dimensional-setting-simultaneous-vs-reduced","position":8},{"hierarchy":{"lvl1":"Introduction and Motivation for PDE-Constrained Optimal Control","lvl2":"3. Finite-Dimensional Setting (Simultaneous vs Reduced)"},"content":"Consider\\min_{y\\in\\mathbb{R}^n,\\,u\\in\\mathbb{R}^m} J(y,u)\n\\quad\\text{s.t.}\\quad Ay=Bu,\n\nwith A\\in\\mathbb{R}^{n\\times n} invertible.","type":"content","url":"/lectures/lecture01#id-3-finite-dimensional-setting-simultaneous-vs-reduced","position":9},{"hierarchy":{"lvl1":"Introduction and Motivation for PDE-Constrained Optimal Control","lvl3":"3.1 Simultaneous formulation","lvl2":"3. Finite-Dimensional Setting (Simultaneous vs Reduced)"},"type":"lvl3","url":"/lectures/lecture01#id-3-1-simultaneous-formulation","position":10},{"hierarchy":{"lvl1":"Introduction and Motivation for PDE-Constrained Optimal Control","lvl3":"3.1 Simultaneous formulation","lvl2":"3. Finite-Dimensional Setting (Simultaneous vs Reduced)"},"content":"Optimize in (y,u) and enforce Ay=Bu explicitly.\n\nInterpretation:\n\noptimization variable: the pair (y,u);\n\ncoupling: y and u are linked by the model equation;\n\ncomputational consequence: every candidate pair must satisfy the constraint.","type":"content","url":"/lectures/lecture01#id-3-1-simultaneous-formulation","position":11},{"hierarchy":{"lvl1":"Introduction and Motivation for PDE-Constrained Optimal Control","lvl3":"3.2 Reduced formulation","lvl2":"3. Finite-Dimensional Setting (Simultaneous vs Reduced)"},"type":"lvl3","url":"/lectures/lecture01#id-3-2-reduced-formulation","position":12},{"hierarchy":{"lvl1":"Introduction and Motivation for PDE-Constrained Optimal Control","lvl3":"3.2 Reduced formulation","lvl2":"3. Finite-Dimensional Setting (Simultaneous vs Reduced)"},"content":"Since A is invertible,y=A^{-1}Bu=:S(u),\n\nwhere S is the control-to-state operator.\nThen definef(u):=J(S(u),u),\n\nand solve\\min_{u\\in\\mathcal{U}_{\\mathrm{ad}}} f(u).\n\nThis reduces a finite-dimensional control problem to a standard finite-dimensional optimization problem.\n\nStep-by-step logic:\n\nthe constraint Ay=Bu defines y uniquely as a function of u;\n\ntherefore the only independent decision variable is u;\n\nthe objective becomes a composite map u\\mapsto J(S(u),u);\n\nall constraint information is encoded in S.","type":"content","url":"/lectures/lecture01#id-3-2-reduced-formulation","position":13},{"hierarchy":{"lvl1":"Introduction and Motivation for PDE-Constrained Optimal Control","lvl2":"4. Existence in Finite Dimensions"},"type":"lvl2","url":"/lectures/lecture01#id-4-existence-in-finite-dimensions","position":14},{"hierarchy":{"lvl1":"Introduction and Motivation for PDE-Constrained Optimal Control","lvl2":"4. Existence in Finite Dimensions"},"content":"A standard existence result for the reduced problem:\n\nIf\n\nf is lower semicontinuous and bounded from below,\n\none level set L_t:=\\{u\\in\\mathcal{U}_{\\mathrm{ad}}:f(u)\\le t\\} is nonempty, closed, and bounded,\n\nthen a minimizer exists.\n\nReason: in finite dimensions, closed and bounded sets are compact (Weierstrass theorem).\n\nWhy this matters for control:\n\nbefore deriving optimality conditions, we need existence of at least one minimizer;\n\nexistence is easy in finite dimension under compactness of level sets;\n\nthis argument will fail in infinite dimensions unless additional structure is used.\n\nImportant warning\n\nIn infinite-dimensional spaces, closed and bounded sets are generally not compact.\nThis is one of the main analytical difficulties for PDE-constrained optimization.","type":"content","url":"/lectures/lecture01#id-4-existence-in-finite-dimensions","position":15},{"hierarchy":{"lvl1":"Introduction and Motivation for PDE-Constrained Optimal Control","lvl2":"5. Unconstrained First/Second-Order Conditions"},"type":"lvl2","url":"/lectures/lecture01#id-5-unconstrained-first-second-order-conditions","position":16},{"hierarchy":{"lvl1":"Introduction and Motivation for PDE-Constrained Optimal Control","lvl2":"5. Unconstrained First/Second-Order Conditions"},"content":"For convex differentiable f on a convex set K:\\nabla f(\\bar u)\\cdot (u-\\bar u)\\ge 0\\quad\\forall u\\in K\n\nis the first-order optimality condition.\n\nSpecial case (interior point):\\nabla f(\\bar u)=0.\n\nIf f\\in C^2 and \\bar u is a local minimizer:\n\n\\nabla f(\\bar u)=0\n\nD^2 f(\\bar u) is positive semidefinite\n\nIf moreover D^2 f(\\bar u) is positive definite, then \\bar u is a strict local minimizer.","type":"content","url":"/lectures/lecture01#id-5-unconstrained-first-second-order-conditions","position":17},{"hierarchy":{"lvl1":"Introduction and Motivation for PDE-Constrained Optimal Control","lvl2":"6. Constrained minimization (2D Example)"},"type":"lvl2","url":"/lectures/lecture01#id-6-constrained-minimization-2d-example","position":18},{"hierarchy":{"lvl1":"Introduction and Motivation for PDE-Constrained Optimal Control","lvl2":"6. Constrained minimization (2D Example)"},"content":"Let\\mathcal{U}_{\\mathrm{ad}}=\\mathbb{R}^2,\\qquad\nf(u)=\\frac12 u^T A u,\\qquad\n\\varphi(u)=Bu-g=0,\n\nwithA\\in\\mathbb{R}^{2\\times 2}\\text{ SPD},\\quad B\\in\\mathbb{R}^{1\\times 2},\\quad g\\in\\mathbb{R}.\n\nLogical interpretation:\n\nobjective level sets are ellipses (because A is SPD);\n\nfeasible points lie on an affine line Bu-g=0;\n\nthe minimizer is where the first objective level set touches that feasible line.\n\nAt an optimal feasible point, \\nabla f is orthogonal to the feasible tangent direction,\nso it must be parallel to \\nabla\\varphi:\\nabla f(\\bar u)=(\\nabla\\varphi(\\bar u))^T\\lambda.\n\nEquivalent first-order form:\\nabla f(\\bar u)-(\\nabla\\varphi(\\bar u))^T\\lambda=0,\n\\qquad\n\\varphi(\\bar u)=0.\n\nMeaning:\n\n\\varphi(\\bar u)=0: feasibility at the solution;\n\ngradient balance: objective gradient is compensated by constraint normal direction;\n\nmultiplier \\lambda: strength/sign of that compensation.","type":"content","url":"/lectures/lecture01#id-6-constrained-minimization-2d-example","position":19},{"hierarchy":{"lvl1":"Introduction and Motivation for PDE-Constrained Optimal Control","lvl3":"Lagrangian Formalism","lvl2":"6. Constrained minimization (2D Example)"},"type":"lvl3","url":"/lectures/lecture01#lagrangian-formalism","position":20},{"hierarchy":{"lvl1":"Introduction and Motivation for PDE-Constrained Optimal Control","lvl3":"Lagrangian Formalism","lvl2":"6. Constrained minimization (2D Example)"},"content":"Define the Lagrangian\\mathcal{L}(u,\\lambda)=f(u)-\\varphi(u)\\cdot\\lambda.\n\nand search for saddle points:\\bar u, \\bar\\lambda = \\arg\\min_u \\arg\\max_\\lambda \\mathcal{L}(u,\\lambda).\n\nStationarity gives\\frac{\\partial\\mathcal{L}}{\\partial u}=0,\n\\qquad\n\\frac{\\partial\\mathcal{L}}{\\partial \\lambda}=0.\n\nFor this quadratic/affine case:\\nabla_u\\mathcal{L}=Au-B^T\\lambda=0,\n\\qquad\n\\nabla_\\lambda\\mathcal{L}=-Bu+g=0,\n\nwhich is the KKT linear system\\begin{pmatrix}A & -B^T \\\\\\ -B & 0\\end{pmatrix}\\begin{pmatrix}u \\\\\\ \\lambda\\end{pmatrix}=\\begin{pmatrix}0 \\\\\\ -g\\end{pmatrix}.\n\nThis is the prototype for all later optimality systems:\n\nstate/constraint equation;\n\nadjoint or multiplier equation;\n\ncoupling through stationarity.\n\n ","type":"content","url":"/lectures/lecture01#lagrangian-formalism","position":21},{"hierarchy":{"lvl1":"Introduction and Motivation for PDE-Constrained Optimal Control","lvl2":"7. From Finite to Infinite Dimensions"},"type":"lvl2","url":"/lectures/lecture01#id-7-from-finite-to-infinite-dimensions","position":22},{"hierarchy":{"lvl1":"Introduction and Motivation for PDE-Constrained Optimal Control","lvl2":"7. From Finite to Infinite Dimensions"},"content":"For PDE-constrained control, state/control live in function spaces (typically Hilbert spaces):\n\nstate space Y (e.g. Sobolev spaces)\n\ncontrol space U\n\nPDE operator \\mathcal{E}(y,u)=0\n\nTypical difficulties:\n\nnon-compactness in infinite dimension\n\nweak vs strong convergence issues\n\ndifferentiability in Banach/Hilbert spaces\n\nadjoint equations for gradient computation\n\nConceptual continuity with the finite-dimensional case:\n\nsame optimization structure;\n\nsame reduced-vs-simultaneous viewpoints;\n\nsame KKT logic;\n\nonly the functional-analytic setting changes.","type":"content","url":"/lectures/lecture01#id-7-from-finite-to-infinite-dimensions","position":23},{"hierarchy":{"lvl1":"Introduction and Motivation for PDE-Constrained Optimal Control","lvl2":"8. Prototypical PDE-Constrained Models"},"type":"lvl2","url":"/lectures/lecture01#id-8-prototypical-pde-constrained-models","position":24},{"hierarchy":{"lvl1":"Introduction and Motivation for PDE-Constrained Optimal Control","lvl2":"8. Prototypical PDE-Constrained Models"},"content":"","type":"content","url":"/lectures/lecture01#id-8-prototypical-pde-constrained-models","position":25},{"hierarchy":{"lvl1":"Introduction and Motivation for PDE-Constrained Optimal Control","lvl3":"8.1 Elliptic distributed control","lvl2":"8. Prototypical PDE-Constrained Models"},"type":"lvl3","url":"/lectures/lecture01#id-8-1-elliptic-distributed-control","position":26},{"hierarchy":{"lvl1":"Introduction and Motivation for PDE-Constrained Optimal Control","lvl3":"8.1 Elliptic distributed control","lvl2":"8. Prototypical PDE-Constrained Models"},"content":"\\min_{(y,u)}\n\\frac12\\|y-y_d\\|_{L^2(\\Omega)}^2\n+\\frac\\alpha2\\|u\\|_{L^2(\\Omega)}^2\n\nsubject to-\\Delta y=u\\text{ in }\\Omega,\n\\qquad y=0\\text{ on }\\partial\\Omega,\n\\qquad u\\in U_{\\mathrm{ad}}.","type":"content","url":"/lectures/lecture01#id-8-1-elliptic-distributed-control","position":27},{"hierarchy":{"lvl1":"Introduction and Motivation for PDE-Constrained Optimal Control","lvl3":"8.2 Parabolic control","lvl2":"8. Prototypical PDE-Constrained Models"},"type":"lvl3","url":"/lectures/lecture01#id-8-2-parabolic-control","position":28},{"hierarchy":{"lvl1":"Introduction and Motivation for PDE-Constrained Optimal Control","lvl3":"8.2 Parabolic control","lvl2":"8. Prototypical PDE-Constrained Models"},"content":"\\partial_t y-\\Delta y=u\\text{ in }Q,\n\\qquad y(\\cdot,0)=y_0,\n\nwith tracking over space-time and Tikhonov regularization.","type":"content","url":"/lectures/lecture01#id-8-2-parabolic-control","position":29},{"hierarchy":{"lvl1":"Introduction and Motivation for PDE-Constrained Optimal Control","lvl3":"8.3 Flow and inverse problems","lvl2":"8. Prototypical PDE-Constrained Models"},"type":"lvl3","url":"/lectures/lecture01#id-8-3-flow-and-inverse-problems","position":30},{"hierarchy":{"lvl1":"Introduction and Motivation for PDE-Constrained Optimal Control","lvl3":"8.3 Flow and inverse problems","lvl2":"8. Prototypical PDE-Constrained Models"},"content":"Navier-Stokes control (nonlinear constraints)\n\nparameter estimation/data assimilation","type":"content","url":"/lectures/lecture01#id-8-3-flow-and-inverse-problems","position":31},{"hierarchy":{"lvl1":"Introduction and Motivation for PDE-Constrained Optimal Control","lvl2":"9. Control Constraints"},"type":"lvl2","url":"/lectures/lecture01#id-9-control-constraints","position":32},{"hierarchy":{"lvl1":"Introduction and Motivation for PDE-Constrained Optimal Control","lvl2":"9. Control Constraints"},"content":"Common box constraints:u_{\\min}\\le u\\le u_{\\max}.\n\nThey lead to variational inequalities and KKT systems in function spaces.","type":"content","url":"/lectures/lecture01#id-9-control-constraints","position":33},{"hierarchy":{"lvl1":"Introduction and Motivation for PDE-Constrained Optimal Control","lvl2":"10. Typical Variations of OCP Formulations"},"type":"lvl2","url":"/lectures/lecture01#id-10-typical-variations-of-ocp-formulations","position":34},{"hierarchy":{"lvl1":"Introduction and Motivation for PDE-Constrained Optimal Control","lvl2":"10. Typical Variations of OCP Formulations"},"content":"Many optimal control models keep the same abstract structure but vary in where the control acts, what is observed, and how the objective is measured.\n\nCommon variations include:\n\nLocalized distributed control: u acts only on a subdomain \\omega\\subset\\Omega (for example through \\chi_\\omega u in the PDE).\n\nBoundary control: u appears in Dirichlet/Neumann/Robin boundary conditions on part of \\partial\\Omega.\n\nInitial-condition control: u is an unknown initial datum in time-dependent models.\n\nParameter control: u is a coefficient (diffusivity, reaction rate, material parameter), not a source term.\n\nDifferent tracking norms: replace L^2 tracking by H^1, weighted norms, or mixed space-time norms.\n\nDifferent control penalties: use L^2, H^1, or sparsity-promoting terms (e.g. L^1-type penalties).\n\nPointwise state constraints: enforce bounds on the state (or output) in the domain or on the boundary.\n\nMulti-objective costs: combine tracking, regularization, and engineering criteria (energy, drag, flux, etc.).\n\nInverse problems / data assimilation: identify unknown inputs/parameters from measurements with regularization.\n\nUncertainty-aware OCPs: optimize expected cost, risk measures, or robust worst-case criteria.\n\nThese variants motivate why we need a flexible theoretical framework and multiple numerical methods in the rest of the course.","type":"content","url":"/lectures/lecture01#id-10-typical-variations-of-ocp-formulations","position":35},{"hierarchy":{"lvl1":"Introduction and Motivation for PDE-Constrained Optimal Control","lvl2":"References for This Lecture"},"type":"lvl2","url":"/lectures/lecture01#references-for-this-lecture","position":36},{"hierarchy":{"lvl1":"Introduction and Motivation for PDE-Constrained Optimal Control","lvl2":"References for This Lecture"},"content":"F. Tr√∂ltzsch, Optimal Control of Partial Differential Equations, Chapter 1\n\nA. Manzoni, A. Quarteroni, S. Salsa, Optimal Control of PDEs, Chapter 1\n\nJ. C. De los Reyes, Numerical PDE-Constrained Optimization, Section 1 FOOTER START \n\nüé¨ View Slides\n\nOpen slides in full screen for the best viewing experience. FOOTER END ","type":"content","url":"/lectures/lecture01#references-for-this-lecture","position":37},{"hierarchy":{"lvl1":"KKT Conditions in Finite Dimensions"},"type":"lvl1","url":"/lectures/lecture02","position":0},{"hierarchy":{"lvl1":"KKT Conditions in Finite Dimensions"},"content":"","type":"content","url":"/lectures/lecture02","position":1},{"hierarchy":{"lvl1":"KKT Conditions in Finite Dimensions","lvl2":"Overview"},"type":"lvl2","url":"/lectures/lecture02#overview","position":2},{"hierarchy":{"lvl1":"KKT Conditions in Finite Dimensions","lvl2":"Overview"},"content":"In this lecture we show the core ideas needed to understand inequality constrained first-order and second-order optimality in finite dimensions.\n\nWe focus on the problem\\min_{u\\in\\mathbb{R}^n} f(u)\n\\quad\\text{s.t.}\\quad\n\\varphi_j(u)\\ge 0,\\; j=1,\\dots,m,\n\nwith f,\\varphi_j\\in C^1(\\mathbb{R}^n).\n\nThe take-home message is simple:\n\nat a constrained minimum there is no admissible descent direction;\n\nthis forces the objective gradient to balance active constraint normals;\n\nthis balance is exactly the KKT system;\n\nsecond order is curvature of the Lagrangian along directions that remain tangent to active constraints.\n\nwith the convention \\mathcal L=f-\\sum_j\\lambda_j\\varphi_j and \\varphi_j\\ge 0, active multipliers are nonnegative, and they vanish for inactive constraints (complementarity).","type":"content","url":"/lectures/lecture02#overview","position":3},{"hierarchy":{"lvl1":"KKT Conditions in Finite Dimensions","lvl2":"1. Problem Setting and Active Constraints"},"type":"lvl2","url":"/lectures/lecture02#id-1-problem-setting-and-active-constraints","position":4},{"hierarchy":{"lvl1":"KKT Conditions in Finite Dimensions","lvl2":"1. Problem Setting and Active Constraints"},"content":"Define the feasible set\\mathcal U_{\\mathrm{ad}}:=\\{u\\in\\mathbb R^n:\\varphi_j(u)\\ge 0\\ \\forall j\\}.\n\nLet \\bar u\\in\\mathcal U_{\\mathrm{ad}} be a local minimizer.\n\nNot all constraints matter equally at \\bar u.\nOnly the constraints that are exactly at the boundary can influence first-order optimality.\nSo we define the active set\\mathcal A(\\bar u):=\\{j\\in\\{1,\\dots,m\\}:\\varphi_j(\\bar u)=0\\}.\n\nInactive constraints satisfy \\varphi_j(\\bar u)>0 and do not contribute at first order. For example: if we have a contact constraint between two bodies (that cannot penetrate), then only the constraints corresponding to points in contact are active, while the others are inactive.","type":"content","url":"/lectures/lecture02#id-1-problem-setting-and-active-constraints","position":5},{"hierarchy":{"lvl1":"KKT Conditions in Finite Dimensions","lvl2":"2. Admissible First-Order Directions"},"type":"lvl2","url":"/lectures/lecture02#id-2-admissible-first-order-directions","position":6},{"hierarchy":{"lvl1":"KKT Conditions in Finite Dimensions","lvl2":"2. Admissible First-Order Directions"},"content":"Near \\bar u, a direction d\\in\\mathbb R^n is first-order admissible if it does not decrease active constraints.\nLinearizing active constraints gives\\nabla\\varphi_j(\\bar u)\\cdot d\\ge 0\n\\quad\\forall j\\in\\mathcal A(\\bar u).\n\nThis condition is the local geometric ingredient we need.\n\nInterpretation:\n\nif \\nabla\\varphi_j(\\bar u)\\cdot d<0, then moving along d pushes outside feasibility for constraint j;\n\nif \\nabla\\varphi_j(\\bar u)\\cdot d\\ge 0, then constraint j is not violated at first order.","type":"content","url":"/lectures/lecture02#id-2-admissible-first-order-directions","position":7},{"hierarchy":{"lvl1":"KKT Conditions in Finite Dimensions","lvl2":"3. First-Order Necessary Condition"},"type":"lvl2","url":"/lectures/lecture02#id-3-first-order-necessary-condition","position":8},{"hierarchy":{"lvl1":"KKT Conditions in Finite Dimensions","lvl2":"3. First-Order Necessary Condition"},"content":"At a local minimizer, every admissible first-order direction must be non-descent:\\nabla f(\\bar u)\\cdot d\\ge 0\n\\quad\\text{for every } d \\text{ such that }\n\\nabla\\varphi_j(\\bar u)\\cdot d\\ge 0\\ \\forall j\\in\\mathcal A(\\bar u).\n\nWhy this is unavoidable:\n\nif there existed one admissible d with \\nabla f(\\bar u)\\cdot d<0,\n\nthen a small step \\bar u+t d (with t>0 small) would decrease the objective while remaining feasible at first order,\n\ncontradicting local minimality.\n\nThis is the true origin of KKT.","type":"content","url":"/lectures/lecture02#id-3-first-order-necessary-condition","position":9},{"hierarchy":{"lvl1":"KKT Conditions in Finite Dimensions","lvl2":"4. From First-Order Geometry to KKT"},"type":"lvl2","url":"/lectures/lecture02#id-4-from-first-order-geometry-to-kkt","position":10},{"hierarchy":{"lvl1":"KKT Conditions in Finite Dimensions","lvl2":"4. From First-Order Geometry to KKT"},"content":"For regular active constraints (the standard finite-dimensional nondegenerate case),\nthere exist multipliers \\lambda_j\\ge 0 such that\\nabla f(\\bar u)-\\sum_{j\\in\\mathcal A(\\bar u)}\\lambda_j\\nabla\\varphi_j(\\bar u)=0.\n\nExtending by \\lambda_j=0 on inactive constraints yields the standard stationarity form\\nabla f(\\bar u)-\\sum_{j=1}^m\\lambda_j\\nabla\\varphi_j(\\bar u)=0.\n\nTogether with primal feasibility and complementarity, we obtain\\begin{aligned}\n\\nabla f(\\bar u)-\\sum_{j=1}^m\\lambda_j\\nabla\\varphi_j(\\bar u) &= 0,\\\\\n\\varphi_j(\\bar u) &\\ge 0,\\quad j=1,\\dots,m,\\\\\n\\lambda_j &\\ge 0,\\quad j=1,\\dots,m,\\\\\n\\lambda_j\\,\\varphi_j(\\bar u) &= 0,\\quad j=1,\\dots,m.\n\\end{aligned}\n\nComplementarity meaning:\n\nif \\varphi_j(\\bar u)>0 (inactive), then \\lambda_j=0;\n\nif \\lambda_j>0, then necessarily \\varphi_j(\\bar u)=0 (active).\n\nRegularity Note\n\nIn finite dimensions, this KKT form is valid under standard nondegeneracy assumptions on active constraints.\nFor box constraints, this regularity is automatic in the usual formulation.","type":"content","url":"/lectures/lecture02#id-4-from-first-order-geometry-to-kkt","position":11},{"hierarchy":{"lvl1":"KKT Conditions in Finite Dimensions","lvl2":"5. Box Constraints: The Prototype Case"},"type":"lvl2","url":"/lectures/lecture02#id-5-box-constraints-the-prototype-case","position":12},{"hierarchy":{"lvl1":"KKT Conditions in Finite Dimensions","lvl2":"5. Box Constraints: The Prototype Case"},"content":"Consider\\min_{u\\in\\mathbb R^n} f(u)\n\\quad\\text{s.t.}\\quad\na_i\\le u_i\\le b_i,\\quad i=1,\\dots,n.\n\nEquivalent inequality form:u_i-a_i\\ge 0,\n\\qquad\nb_i-u_i\\ge 0.\n\nThe componentwise first-order condition becomes\\begin{cases}\n\\partial_i f(\\bar u)\\ge 0 & \\text{if } \\bar u_i=a_i,\\\\\n\\partial_i f(\\bar u)\\le 0 & \\text{if } \\bar u_i=b_i,\\\\\n\\partial_i f(\\bar u)=0 & \\text{if } a_i<\\bar u_i<b_i.\n\\end{cases}\n\nThis is the exact finite-dimensional model behind bound-constrained control variables in PDE-constrained optimization.","type":"content","url":"/lectures/lecture02#id-5-box-constraints-the-prototype-case","position":13},{"hierarchy":{"lvl1":"KKT Conditions in Finite Dimensions","lvl2":"6. Second-Order Conditions"},"type":"lvl2","url":"/lectures/lecture02#id-6-second-order-conditions","position":14},{"hierarchy":{"lvl1":"KKT Conditions in Finite Dimensions","lvl2":"6. Second-Order Conditions"},"content":"Define the Lagrangian\\mathcal L(u,\\lambda):=f(u)-\\sum_{j=1}^m\\lambda_j\\varphi_j(u).\n\nAfter first-order conditions are satisfied, the next question is curvature along first-order feasible/tangent directions.\nA practical critical set is\\mathcal C(\\bar u):=\\{d:\\nabla\\varphi_j(\\bar u)\\cdot d\\ge 0\\ \\forall j\\in\\mathcal A(\\bar u),\\ \\nabla f(\\bar u)\\cdot d=0\\}.\n\nSecond-order necessary condition:d^T\\nabla^2_{uu}\\mathcal L(\\bar u,\\lambda)d\\ge 0\n\\quad\\forall d\\in\\mathcal C(\\bar u).\n\nSecond-order sufficient condition (strict local minimality):d^T\\nabla^2_{uu}\\mathcal L(\\bar u,\\lambda)d>0\n\\quad\\forall d\\in\\mathcal C(\\bar u)\\setminus\\{0\\}.\n\nInterpretation:\n\nfirst order kills linear descent along admissible directions;\n\nsecond order checks that curvature is positive on directions where first order is neutral.","type":"content","url":"/lectures/lecture02#id-6-second-order-conditions","position":15},{"hierarchy":{"lvl1":"KKT Conditions in Finite Dimensions","lvl2":"7. Summary"},"type":"lvl2","url":"/lectures/lecture02#id-7-summary","position":16},{"hierarchy":{"lvl1":"KKT Conditions in Finite Dimensions","lvl2":"7. Summary"},"content":"At a constrained local minimizer:\n\nno admissible first-order direction can decrease f;\n\nthis forces a balance between objective gradient and active constraint normals;\n\nthat balance is KKT with nonnegative multipliers and complementarity;\n\nsecond order is positivity of Lagrangian curvature on critical directions.\n\nThis is the essential finite-dimensional picture we need before moving to PDE-constrained settings. FOOTER START \n\nüé¨ View Slides\n\nOpen slides in full screen for the best viewing experience. FOOTER END ","type":"content","url":"/lectures/lecture02#id-7-summary","position":17},{"hierarchy":{"lvl1":"Introduction & Motivation"},"type":"lvl1","url":"/slides/slides01","position":0},{"hierarchy":{"lvl1":"Introduction & Motivation"},"content":"Numerical Methods for Optimal Control (NMOPT)\n\nLuca Heltai (\n\nluca‚Äã.heltai@unipi‚Äã.it)","type":"content","url":"/slides/slides01","position":1},{"hierarchy":{"lvl1":"Introduction & Motivation","lvl2":"What Is Optimal Control?"},"type":"lvl2","url":"/slides/slides01#what-is-optimal-control","position":2},{"hierarchy":{"lvl1":"Introduction & Motivation","lvl2":"What Is Optimal Control?"},"content":"Choose a control u to minimize a cost J(y,u).\n\nThe state y is constrained by a model (often a PDE).\n\nOptimization + differential constraints = PDE-constrained optimization.","type":"content","url":"/slides/slides01#what-is-optimal-control","position":3},{"hierarchy":{"lvl1":"Introduction & Motivation","lvl2":"Abstract Formulation"},"type":"lvl2","url":"/slides/slides01#abstract-formulation","position":4},{"hierarchy":{"lvl1":"Introduction & Motivation","lvl2":"Abstract Formulation"},"content":"Minimize\\min_{y,u} \\; J(y,u)\n\nsubject to the state equation\\mathcal{E}(y,u) = 0.\n\nTypical pieces:\n\nstate equation (PDE)\n\nadmissible controls u \\in \\mathcal{U}_{\\mathrm{ad}}\n\nconstraints (box constraints, etc.)","type":"content","url":"/slides/slides01#abstract-formulation","position":5},{"hierarchy":{"lvl1":"Introduction & Motivation","lvl2":"Forward vs Optimal Control"},"type":"lvl2","url":"/slides/slides01#forward-vs-optimal-control","position":6},{"hierarchy":{"lvl1":"Introduction & Motivation","lvl2":"Forward vs Optimal Control"},"content":"Forward (direct) problem:\n\ninput data given\n\nsolve PDE once to compute y\n\nOptimal control:\n\ncontrol u unknown\n\nPDE is solved repeatedly while optimizing J\n\nKey point: the PDE is a constraint, not the objective.","type":"content","url":"/slides/slides01#forward-vs-optimal-control","position":7},{"hierarchy":{"lvl1":"Introduction & Motivation","lvl2":"Reduced Formulation"},"type":"lvl2","url":"/slides/slides01#reduced-formulation","position":8},{"hierarchy":{"lvl1":"Introduction & Motivation","lvl2":"Reduced Formulation"},"content":"If the state equation defines a control-to-state map S:y = S(u),\n\nthen define the reduced costf(u) := J(S(u),u),\n\nand solve\\min_{u} f(u).\n\nWhy it matters:\n\nseparates ‚ÄúPDE solve‚Äù from ‚Äúoptimization step‚Äù\n\nmakes gradients/adjoins systematic","type":"content","url":"/slides/slides01#reduced-formulation","position":9},{"hierarchy":{"lvl1":"Introduction & Motivation","lvl2":"Tiny Example Notebook"},"type":"lvl2","url":"/slides/slides01#tiny-example-notebook","position":10},{"hierarchy":{"lvl1":"Introduction & Motivation","lvl2":"Tiny Example Notebook"},"content":"Finite-dimensional LQ reduction + a 1D slice plot.\n\nGenerates figures used in these slides.\n\nFile: codes/lecture01/finite_dim_analogy.ipynb","type":"content","url":"/slides/slides01#tiny-example-notebook","position":11},{"hierarchy":{"lvl1":"Introduction & Motivation","lvl2":"Example: Reduced Cost Shape"},"type":"lvl2","url":"/slides/slides01#example-reduced-cost-shape","position":12},{"hierarchy":{"lvl1":"Introduction & Motivation","lvl2":"Example: Reduced Cost Shape"},"content":"","type":"content","url":"/slides/slides01#example-reduced-cost-shape","position":13},{"hierarchy":{"lvl1":"Introduction & Motivation","lvl2":"Control-to-State Pipeline"},"type":"lvl2","url":"/slides/slides01#control-to-state-pipeline","position":14},{"hierarchy":{"lvl1":"Introduction & Motivation","lvl2":"Control-to-State Pipeline"},"content":"","type":"content","url":"/slides/slides01#control-to-state-pipeline","position":15},{"hierarchy":{"lvl1":"Introduction & Motivation","lvl2":"A Finite-Dimensional Analogy"},"type":"lvl2","url":"/slides/slides01#a-finite-dimensional-analogy","position":16},{"hierarchy":{"lvl1":"Introduction & Motivation","lvl2":"A Finite-Dimensional Analogy"},"content":"Given A y = B u with invertible A:y = A^{-1} B u =: S u\n\nReduced problem:\\min_u f(u) := J(Su,u).\n\nThis is the template we will reuse in infinite dimensions.","type":"content","url":"/slides/slides01#a-finite-dimensional-analogy","position":17},{"hierarchy":{"lvl1":"Introduction & Motivation","lvl2":"Constrained Minimization in 2D"},"type":"lvl2","url":"/slides/slides01#constrained-minimization-in-2d","position":18},{"hierarchy":{"lvl1":"Introduction & Motivation","lvl2":"Constrained Minimization in 2D"},"content":"Consider\\min_{u\\in\\mathbb{R}^2} f(u)=\\frac12 u^T A u\n\\quad \\text{s.t.} \\quad\n\\varphi(u)=Bu-g=0,\n\nwith A SPD, B\\in\\mathbb{R}^{1\\times 2}.\n\nAt an optimum:\\nabla f(\\bar u)-(\\nabla\\varphi(\\bar u))^T\\lambda=0,\n\\qquad\n\\varphi(\\bar u)=0.","type":"content","url":"/slides/slides01#constrained-minimization-in-2d","position":19},{"hierarchy":{"lvl1":"Introduction & Motivation","lvl2":"Lagrangian and KKT System"},"type":"lvl2","url":"/slides/slides01#lagrangian-and-kkt-system","position":20},{"hierarchy":{"lvl1":"Introduction & Motivation","lvl2":"Lagrangian and KKT System"},"content":"Lagrangian:\\mathcal{L}(u,\\lambda)=f(u)-\\varphi(u)\\cdot \\lambda\n\nStationarity:\\nabla_u\\mathcal{L}=Au-B^T\\lambda=0,\\qquad\n\\nabla_\\lambda\\mathcal{L}=-Bu+g=0.\n\nEquivalent saddle-point linear system\\begin{pmatrix}A & -B^T \\\\\\ -B & 0\\end{pmatrix}\\begin{pmatrix}u \\\\\\ \\lambda\\end{pmatrix}=\\begin{pmatrix}0 \\\\\\ -g\\end{pmatrix}","type":"content","url":"/slides/slides01#lagrangian-and-kkt-system","position":21},{"hierarchy":{"lvl1":"Introduction & Motivation","lvl2":"2D Constrained Geometry"},"type":"lvl2","url":"/slides/slides01#id-2d-constrained-geometry","position":22},{"hierarchy":{"lvl1":"Introduction & Motivation","lvl2":"2D Constrained Geometry"},"content":"","type":"content","url":"/slides/slides01#id-2d-constrained-geometry","position":23},{"hierarchy":{"lvl1":"Introduction & Motivation","lvl2":"Objective on the Feasible Line"},"type":"lvl2","url":"/slides/slides01#objective-on-the-feasible-line","position":24},{"hierarchy":{"lvl1":"Introduction & Motivation","lvl2":"Objective on the Feasible Line"},"content":"","type":"content","url":"/slides/slides01#objective-on-the-feasible-line","position":25},{"hierarchy":{"lvl1":"Introduction & Motivation","lvl2":"When PDEs Show Up"},"type":"lvl2","url":"/slides/slides01#when-pdes-show-up","position":26},{"hierarchy":{"lvl1":"Introduction & Motivation","lvl2":"When PDEs Show Up"},"content":"States: temperature, displacement, velocity, concentration, ...\n\nControls:\n\ndistributed sources\n\nboundary inputs\n\ninitial conditions\n\nparameters / coefficients","type":"content","url":"/slides/slides01#when-pdes-show-up","position":27},{"hierarchy":{"lvl1":"Introduction & Motivation","lvl2":"Typical Examples"},"type":"lvl2","url":"/slides/slides01#typical-examples","position":28},{"hierarchy":{"lvl1":"Introduction & Motivation","lvl2":"Typical Examples"},"content":"Elliptic: stationary heating / diffusion\n\nParabolic: time-dependent heating\n\nNonlinear: Navier-Stokes flow control\n\nInverse problems: parameter estimation / data assimilation","type":"content","url":"/slides/slides01#typical-examples","position":29},{"hierarchy":{"lvl1":"Introduction & Motivation","lvl2":"Constraints"},"type":"lvl2","url":"/slides/slides01#constraints","position":30},{"hierarchy":{"lvl1":"Introduction & Motivation","lvl2":"Constraints"},"content":"Common: box constraints on the controlu_{\\min} \\le u \\le u_{\\max}.\n\nLeads to:\n\nvariational inequalities\n\nKKT conditions\n\nactive-set / projection-type algorithms","type":"content","url":"/slides/slides01#constraints","position":31},{"hierarchy":{"lvl1":"Introduction & Motivation","lvl2":"Typical OCP Variations"},"type":"lvl2","url":"/slides/slides01#typical-ocp-variations","position":32},{"hierarchy":{"lvl1":"Introduction & Motivation","lvl2":"Typical OCP Variations"},"content":"distributed control on a subdomain \\omega\\subset\\Omega\n\nboundary control on part of \\partial\\Omega\n\ninitial-condition control in time-dependent models\n\nparameter identification (inverse problems / data assimilation)\n\nalternative tracking norms (L^2, H^1, weighted, mixed)\n\nalternative regularization (L^2, H^1, sparsity-promoting terms)\n\npointwise state constraints\n\nrobust / uncertainty-aware objectives","type":"content","url":"/slides/slides01#typical-ocp-variations","position":33},{"hierarchy":{"lvl1":"KKT Conditions in Finite Dimensions"},"type":"lvl1","url":"/slides/slides02","position":0},{"hierarchy":{"lvl1":"KKT Conditions in Finite Dimensions"},"content":"Numerical Methods for Optimal Control (NMOPT)\n\nLuca Heltai (\n\nluca‚Äã.heltai@unipi‚Äã.it)","type":"content","url":"/slides/slides02","position":1},{"hierarchy":{"lvl1":"KKT Conditions in Finite Dimensions","lvl2":"Problem Setting"},"type":"lvl2","url":"/slides/slides02#problem-setting","position":2},{"hierarchy":{"lvl1":"KKT Conditions in Finite Dimensions","lvl2":"Problem Setting"},"content":"We consider\\min_{u\\in\\mathbb{R}^n} f(u)\\quad\\text{s.t.}\\quad \\varphi_j(u)\\ge 0,\\; j=1,\\dots,m.\n\nFeasible set:\\mathcal U_{\\mathrm{ad}}:=\\{u\\in\\mathbb R^n:\\varphi_j(u)\\ge 0\\ \\forall j\\}.\n\nActive set at \\bar u:\\mathcal A(\\bar u):=\\{j:\\varphi_j(\\bar u)=0\\}.","type":"content","url":"/slides/slides02#problem-setting","position":3},{"hierarchy":{"lvl1":"KKT Conditions in Finite Dimensions","lvl2":"First-Order Admissible Directions"},"type":"lvl2","url":"/slides/slides02#first-order-admissible-directions","position":4},{"hierarchy":{"lvl1":"KKT Conditions in Finite Dimensions","lvl2":"First-Order Admissible Directions"},"content":"Linearized admissibility at \\bar u:\\nabla\\varphi_j(\\bar u)\\cdot d\\ge 0\\quad \\forall j\\in\\mathcal A(\\bar u).\n\nInterpretation:\n\nnegative product violates constraint j at first order\n\nnonnegative product keeps constraint j admissible at first order","type":"content","url":"/slides/slides02#first-order-admissible-directions","position":5},{"hierarchy":{"lvl1":"KKT Conditions in Finite Dimensions","lvl2":"First-Order Necessary Condition"},"type":"lvl2","url":"/slides/slides02#first-order-necessary-condition","position":6},{"hierarchy":{"lvl1":"KKT Conditions in Finite Dimensions","lvl2":"First-Order Necessary Condition"},"content":"At a local constrained minimizer:\\nabla f(\\bar u)\\cdot d\\ge 0\\quad\\text{for all admissible }d.\n\nWhy:\n\nif an admissible d had \\nabla f(\\bar u)\\cdot d<0\n\nthen \\bar u+t d would decrease f for small t>0\n\ncontradiction with local optimality","type":"content","url":"/slides/slides02#first-order-necessary-condition","position":7},{"hierarchy":{"lvl1":"KKT Conditions in Finite Dimensions","lvl2":"Geometric Example A"},"type":"lvl2","url":"/slides/slides02#geometric-example-a","position":8},{"hierarchy":{"lvl1":"KKT Conditions in Finite Dimensions","lvl2":"Geometric Example A"},"content":"Single active inequality: halfspace tangent set and polar ray.","type":"content","url":"/slides/slides02#geometric-example-a","position":9},{"hierarchy":{"lvl1":"KKT Conditions in Finite Dimensions","lvl2":"Geometric Example B"},"type":"lvl2","url":"/slides/slides02#geometric-example-b","position":10},{"hierarchy":{"lvl1":"KKT Conditions in Finite Dimensions","lvl2":"Geometric Example B"},"content":"First-quadrant cone and opposite-quadrant polar.","type":"content","url":"/slides/slides02#geometric-example-b","position":11},{"hierarchy":{"lvl1":"KKT Conditions in Finite Dimensions","lvl2":"Geometric Example C"},"type":"lvl2","url":"/slides/slides02#geometric-example-c","position":12},{"hierarchy":{"lvl1":"KKT Conditions in Finite Dimensions","lvl2":"Geometric Example C"},"content":"Ray and its polar halfspace.","type":"content","url":"/slides/slides02#geometric-example-c","position":13},{"hierarchy":{"lvl1":"KKT Conditions in Finite Dimensions","lvl2":"KKT System"},"type":"lvl2","url":"/slides/slides02#kkt-system","position":14},{"hierarchy":{"lvl1":"KKT Conditions in Finite Dimensions","lvl2":"KKT System"},"content":"For regular active constraints, there exist multipliers \\lambda_j\\ge 0 such that\\nabla f(\\bar u)-\\sum_{j=1}^m\\lambda_j\\nabla\\varphi_j(\\bar u)=0.\n\nTogether with feasibility/complementarity:\\varphi_j(\\bar u)\\ge 0,\\quad \\lambda_j\\ge 0,\\quad \\lambda_j\\varphi_j(\\bar u)=0.","type":"content","url":"/slides/slides02#kkt-system","position":15},{"hierarchy":{"lvl1":"KKT Conditions in Finite Dimensions","lvl2":"Box Constraints"},"type":"lvl2","url":"/slides/slides02#box-constraints","position":16},{"hierarchy":{"lvl1":"KKT Conditions in Finite Dimensions","lvl2":"Box Constraints"},"content":"a_i\\le u_i\\le b_i\\quad\\Longleftrightarrow\\quad u_i-a_i\\ge 0,\\; b_i-u_i\\ge 0.\n\nComponentwise first-order condition:\\partial_i f(\\bar u)\\begin{cases}\\ge 0 & \\bar u_i=a_i\\\\ \\le 0 & \\bar u_i=b_i\\\\ =0 & a_i<\\bar u_i<b_i\\end{cases}\n\nThis is the prototype for bound-constrained controls in PDE settings.","type":"content","url":"/slides/slides02#box-constraints","position":17},{"hierarchy":{"lvl1":"KKT Conditions in Finite Dimensions","lvl2":"Second Order"},"type":"lvl2","url":"/slides/slides02#second-order","position":18},{"hierarchy":{"lvl1":"KKT Conditions in Finite Dimensions","lvl2":"Second Order"},"content":"Lagrangian:\\mathcal L(u,\\lambda):=f(u)-\\sum_{j=1}^m\\lambda_j\\varphi_j(u).\n\nCritical directions (minimal form):\\mathcal C(\\bar u):=\\{d:\\nabla\\varphi_j(\\bar u)\\cdot d\\ge 0\\ \\forall j\\in\\mathcal A(\\bar u),\\ \\nabla f(\\bar u)\\cdot d=0\\}.\n\nNecessary:d^T\\nabla^2_{uu}\\mathcal L(\\bar u,\\lambda)d\\ge 0\\quad\\forall d\\in\\mathcal C(\\bar u).","type":"content","url":"/slides/slides02#second-order","position":19},{"hierarchy":{"lvl1":"KKT Conditions in Finite Dimensions","lvl2":"Summary"},"type":"lvl2","url":"/slides/slides02#summary","position":20},{"hierarchy":{"lvl1":"KKT Conditions in Finite Dimensions","lvl2":"Summary"},"content":"No admissible descent directions at a constrained minimum.\n\nThis gives gradient balance with active constraint normals.\n\nThat balance is KKT with nonnegative multipliers.\n\nSecond order checks Lagrangian curvature on critical directions.","type":"content","url":"/slides/slides02#summary","position":21}]}