{"version":"1","records":[{"hierarchy":{"lvl1":"Finite-Dimensional Analogy"},"type":"lvl1","url":"/finite-dim-analogy","position":0},{"hierarchy":{"lvl1":"Finite-Dimensional Analogy"},"content":"This notebook illustrates the reduced formulation idea on a tiny linear-quadratic problem.\n\nWe consider a constraint A y = B u (invertible A) and a quadratic objectiveJ(y,u) = \\tfrac12\\|y - y_d\\|^2 + \\tfrac\\alpha2\\|u\\|^2.\n\nEliminating y gives y = S u with S = A^{-1}B, hence the reduced cost f(u)=J(Su,u).\n\nimport numpy as np\nimport matplotlib.pyplot as plt\nfrom pathlib import Path\n\nROOT = Path.cwd().parents[1]\nOUT_DIR = ROOT / \"jupyterbook\" / \"slides\" / \"assets\" / \"lecture01\"\nOUT_DIR.mkdir(parents=True, exist_ok=True)\n\nnp.random.seed(0)\n\n\n\n","type":"content","url":"/finite-dim-analogy","position":1},{"hierarchy":{"lvl1":"Finite-Dimensional Analogy","lvl2":"Build a Tiny Problem"},"type":"lvl2","url":"/finite-dim-analogy#build-a-tiny-problem","position":2},{"hierarchy":{"lvl1":"Finite-Dimensional Analogy","lvl2":"Build a Tiny Problem"},"content":"We‚Äôll work with small matrices and verify that the reduced cost is convex and has a unique minimizer.\n\nn, m = 6, 3\nA = np.random.randn(n, n)\nA = A.T @ A + 0.5 * np.eye(n)  # SPD => invertible\nB = np.random.randn(n, m)\nalpha = 1e-2\ny_d = np.random.randn(n)\n\nS = np.linalg.solve(A, B)\n\ndef J(y, u):\n    return 0.5 * np.dot(y - y_d, y - y_d) + 0.5 * alpha * np.dot(u, u)\n\ndef f(u):\n    y = S @ u\n    return J(y, u)\n\n\n\n","type":"content","url":"/finite-dim-analogy#build-a-tiny-problem","position":3},{"hierarchy":{"lvl1":"Finite-Dimensional Analogy","lvl2":"Closed-Form Minimizer"},"type":"lvl2","url":"/finite-dim-analogy#closed-form-minimizer","position":4},{"hierarchy":{"lvl1":"Finite-Dimensional Analogy","lvl2":"Closed-Form Minimizer"},"content":"For this quadratic reduced problem, the minimizer solves(S^T S + \\alpha I)u = S^T y_d.\n\nH = S.T @ S + alpha * np.eye(m)\nrhs = S.T @ y_d\nu_star = np.linalg.solve(H, rhs)\ny_star = S @ u_star\n\nf_star = f(u_star)\nf_star\n\n\n\n","type":"content","url":"/finite-dim-analogy#closed-form-minimizer","position":5},{"hierarchy":{"lvl1":"Finite-Dimensional Analogy","lvl2":"A 1D Slice Plot"},"type":"lvl2","url":"/finite-dim-analogy#a-1d-slice-plot","position":6},{"hierarchy":{"lvl1":"Finite-Dimensional Analogy","lvl2":"A 1D Slice Plot"},"content":"Plot f(u_* + t d) along a random direction d.\n\nd = np.random.randn(m)\nd /= np.linalg.norm(d)\nt = np.linspace(-2.0, 2.0, 300)\nvals = np.array([f(u_star + ti * d) for ti in t])\n\nfig, ax = plt.subplots(figsize=(6.0, 3.5))\nax.plot(t, vals, linewidth=2)\nax.axvline(0.0, linestyle=\"--\", linewidth=1.5)\nax.set_title(\"Reduced cost along a 1D slice\")\nax.set_xlabel(\"t\")\nax.set_ylabel(r\"$f(u_* + t d)$\")\nax.grid(True, alpha=0.25)\nfig.savefig(OUT_DIR / \"reduced_cost_slice.png\", dpi=200, bbox_inches=\"tight\")\n# plt.close(fig)\n\nOUT_DIR / \"reduced_cost_slice.png\"\n\n\n\n\n\n","type":"content","url":"/finite-dim-analogy#a-1d-slice-plot","position":7},{"hierarchy":{"lvl1":"Finite-Dimensional Analogy","lvl2":"Constrained Minimization Example (2D)"},"type":"lvl2","url":"/finite-dim-analogy#constrained-minimization-example-2d","position":8},{"hierarchy":{"lvl1":"Finite-Dimensional Analogy","lvl2":"Constrained Minimization Example (2D)"},"content":"We consider the finite-dimensional constrained problem:\\min_{u\\in\\mathbb{R}^2} f(u)=\\frac12 u^T A u\n\\quad\\text{s.t.}\\quad\n\\varphi(u)=Bu-g=0,\n\nwith A symmetric positive definite, B\\in\\mathbb{R}^{1\\times 2}, g\\in\\mathbb{R}.\n\nKKT conditions for the Lagrangian\\mathcal{L}(u,\\lambda)=f(u)-\\lambda(Bu-g)\n\nareAu-B^T\\lambda=0,\\qquad Bu-g=0,\n\nwhich gives the linear saddle-point system\n$$\\begin{pmatrix}\nA & -B^T\\\\\n-B & 0\n\\end{pmatrix}\\begin{pmatrix}\nu\\\\\\lambda\\end{pmatrix}\n\n=\\begin{pmatrix}0\\\\-g\\end{pmatrix}\n\n$$\n\n# 2D constrained minimization: geometry + 1D feasible restriction\nA2 = np.array([[3.0, 1.0], [1.0, 2.0]], dtype=float)\nB2 = np.array([[1.0, -1.0]], dtype=float)\ng2 = np.array([0.5], dtype=float)\n\nkkt = np.block([[A2, -B2.T], [-B2, np.zeros((1, 1))]])\nrhs = np.concatenate([np.zeros(2), -g2])\nsol = np.linalg.solve(kkt, rhs)\nu2_star = sol[:2]\nlambda2_star = sol[2]\n\nprint('u* =', u2_star)\nprint('lambda* =', lambda2_star)\n\n# Contours of f(u) and constraint line Bu=g\nu1 = np.linspace(-1.2, 1.8, 400)\nu2 = np.linspace(-1.2, 1.8, 400)\nU1, U2 = np.meshgrid(u1, u2)\nF2 = 0.5 * (A2[0, 0] * U1**2 + 2.0 * A2[0, 1] * U1 * U2 + A2[1, 1] * U2**2)\n\nfig, ax = plt.subplots(figsize=(6.2, 4.6))\nlevels = np.linspace(0.1, 4.0, 9)\nax.contour(U1, U2, F2, levels=levels, cmap='Greens', linewidths=1.5)\n\nline_u1 = np.array([u1.min(), u1.max()])\nline_u2 = line_u1 - g2[0]  # u2 = u1 - g\nax.plot(line_u1, line_u2, color='purple', linewidth=2.2, label=r'$\\varphi(u)=Bu-g=0$')\n\nax.scatter(u2_star[0], u2_star[1], color='navy', s=50, zorder=5)\nax.text(u2_star[0] + 0.05, u2_star[1] + 0.03, r'$u^\\star$', color='navy')\n\ngrad_f = A2 @ u2_star\ngrad_phi = B2.ravel()\nscale = 0.28\nax.arrow(u2_star[0], u2_star[1], scale * grad_f[0], scale * grad_f[1],\n         width=0.004, head_width=0.05, color='tab:red', length_includes_head=True)\nax.text(u2_star[0] + scale * grad_f[0] + 0.03,\n        u2_star[1] + scale * grad_f[1] + 0.02,\n        r'$\\nabla f(u^\\star)$', color='tab:red')\n\nax.arrow(u2_star[0], u2_star[1], scale * grad_phi[0], scale * grad_phi[1],\n         width=0.004, head_width=0.05, color='tab:blue', length_includes_head=True)\nax.text(u2_star[0] + scale * grad_phi[0] + 0.03,\n        u2_star[1] + scale * grad_phi[1] + 0.02,\n        r'$\\nabla \\varphi$', color='tab:blue')\n\nax.set_title('2D constrained minimization: geometry')\nax.set_xlabel(r'$u_1$')\nax.set_ylabel(r'$u_2$')\nax.set_aspect('equal', adjustable='box')\nax.set_xlim(u1.min(), u1.max())\nax.set_ylim(u2.min(), u2.max())\nax.grid(True, alpha=0.25)\nax.legend(loc='upper left')\nfig.savefig(OUT_DIR / 'minimization_geometry.png', dpi=200, bbox_inches='tight')\n\n# Restrict to the feasible line u(t)=u0+t d where B d = 0\nu0 = np.array([g2[0], 0.0])\nd = np.array([1.0, 1.0])\nt = np.linspace(-1.5, 1.5, 300)\nUline = u0[None, :] + t[:, None] * d[None, :]\nvals_line = 0.5 * np.einsum('bi,ij,bj->b', Uline, A2, Uline)\n\nt_star = t[np.argmin(vals_line)]\n\nfig, ax = plt.subplots(figsize=(6.0, 3.6))\nax.plot(t, vals_line, linewidth=2.0)\nax.axvline(t_star, linestyle='--', linewidth=1.5)\nax.set_title(r'$f(u(t))$ on the constraint $\\varphi(u)=0$')\nax.set_xlabel(r'$t$ (feasible direction parameter)')\nax.set_ylabel(r'$f(u(t))$')\nax.grid(True, alpha=0.25)\nax.text(t_star + 0.04, float(np.min(vals_line)) + 0.03, rf'$t^\\star \\approx {t_star:.3f}$', fontsize=10)\nfig.savefig(OUT_DIR / 'minimization_on_constraint.png', dpi=200, bbox_inches='tight')\n\nOUT_DIR / 'minimization_geometry.png', OUT_DIR / 'minimization_on_constraint.png'\n\n\n\n","type":"content","url":"/finite-dim-analogy#constrained-minimization-example-2d","position":9},{"hierarchy":{"lvl1":"Finite-Dimensional Analogy","lvl2":"What Changes for PDEs"},"type":"lvl2","url":"/finite-dim-analogy#what-changes-for-pdes","position":10},{"hierarchy":{"lvl1":"Finite-Dimensional Analogy","lvl2":"What Changes for PDEs"},"content":"S becomes the solution operator of a PDE (still linear in LQ elliptic problems).\n\nGradients are computed efficiently via adjoints (no explicit S matrix).","type":"content","url":"/finite-dim-analogy#what-changes-for-pdes","position":11},{"hierarchy":{"lvl1":"Numerical Methods for Optimal Control"},"type":"lvl1","url":"/","position":0},{"hierarchy":{"lvl1":"Numerical Methods for Optimal Control"},"content":"","type":"content","url":"/","position":1},{"hierarchy":{"lvl1":"Numerical Methods for Optimal Control","lvl2":"Course Objectives"},"type":"lvl2","url":"/#course-objectives","position":2},{"hierarchy":{"lvl1":"Numerical Methods for Optimal Control","lvl2":"Course Objectives"},"content":"The course introduces the mathematical theory and numerical methods for PDE-constrained optimal control problems.The focus is on:\n\nrigorous formulation of optimal control problems governed by PDEs;\n\nderivation of first-order (and selected second-order) optimality conditions;\n\nfinite element discretization of optimal control problems;\n\nimplementation of numerical algorithms using deal.II.\n\nAt the end of the course, students will be able to develop and analyze research-level prototype codes for PDE-constrained optimization.","type":"content","url":"/#course-objectives","position":3},{"hierarchy":{"lvl1":"Numerical Methods for Optimal Control","lvl2":"Prerequisites"},"type":"lvl2","url":"/#prerequisites","position":4},{"hierarchy":{"lvl1":"Numerical Methods for Optimal Control","lvl2":"Prerequisites"},"content":"Advanced calculus\n\nPartial differential equations (elliptic and parabolic)\n\nNumerical methods for PDEs (finite element methods)\n\nProgramming in C++ and Python is helpful for the laboratories, but not required for the lectures\n\nBasic familiarity with Linux and scientific software tools.\n\nPrevious experience with deal.II is helpful but not mandatory.","type":"content","url":"/#prerequisites","position":5},{"hierarchy":{"lvl1":"Numerical Methods for Optimal Control","lvl2":"Numerical Laboratories (deal.II, Python)"},"type":"lvl2","url":"/#numerical-laboratories-deal-ii-python","position":6},{"hierarchy":{"lvl1":"Numerical Methods for Optimal Control","lvl2":"Numerical Laboratories (deal.II, Python)"},"content":"The laboratories are an integral part of the course and include:\n\ndistributed control of the Poisson equation;\n\nstate‚Äìadjoint formulation and reduced gradient methods;\n\nbox constraints on the control (projection methods, PDAS);\n\ntime-dependent optimal control problems;\n\nanalysis of computational performance and scalability.\n\nThe codes:\n\nare written in C++ and Python;\n\nare based on deal.II\n\nare designed as starting points for extensions and final projects\n\nwill be provided with detailed documentation and comments for you to understand and modify.","type":"content","url":"/#numerical-laboratories-deal-ii-python","position":7},{"hierarchy":{"lvl1":"Numerical Methods for Optimal Control","lvl2":"References"},"type":"lvl2","url":"/#references","position":8},{"hierarchy":{"lvl1":"Numerical Methods for Optimal Control","lvl2":"References"},"content":"F. Tr√∂ltzsch, Optimal Control of Partial Differential Equations, AMS, 2010\n\nA. Manzoni, A. Quarteroni, S. Salsa, Optimal Control of Partial Differential Equations, Springer, 2021\n\nJ. C. De los Reyes, Numerical PDE-Constrained Optimization, Springer, 2015\n\nAdditional references are provided within the individual chapters.","type":"content","url":"/#references","position":9},{"hierarchy":{"lvl1":"Numerical Methods for Optimal Control","lvl2":"License"},"type":"lvl2","url":"/#license","position":10},{"hierarchy":{"lvl1":"Numerical Methods for Optimal Control","lvl2":"License"},"content":"The content of this repository is licensed under the MIT License. See the \n\nLICENSE file for details.\n\nUse the table of contents to navigate the 20 sessions (each ~2h).\n\nCourse at a Glance\n\nFormat: 20 sessions (~2h each), lectures + laboratories.\n\nStructure: 3 blocks (Foundations -> Numerics -> Nonlinear/advanced topics).\n\nQuick links: \n\nLecture 01, \n\nSlides 01.","type":"content","url":"/#license","position":11},{"hierarchy":{"lvl1":"Numerical Methods for Optimal Control","lvl2":"Course Topic Summary"},"type":"lvl2","url":"/#course-topic-summary","position":12},{"hierarchy":{"lvl1":"Numerical Methods for Optimal Control","lvl2":"Course Topic Summary"},"content":"The course is organized into three main blocks, progressing from foundational concepts to advanced numerical methods and applications. The emphasis is on PDE-constrained optimal control, with systematic integration of theory and numerical implementation.","type":"content","url":"/#course-topic-summary","position":13},{"hierarchy":{"lvl1":"Numerical Methods for Optimal Control","lvl3":"Block I: Foundations and Linear Elliptic Optimal Control (Lectures 1-6)","lvl2":"Course Topic Summary"},"type":"lvl3","url":"/#block-i-foundations-and-linear-elliptic-optimal-control-lectures-1-6","position":14},{"hierarchy":{"lvl1":"Numerical Methods for Optimal Control","lvl3":"Block I: Foundations and Linear Elliptic Optimal Control (Lectures 1-6)","lvl2":"Course Topic Summary"},"content":"This block introduces the mathematical framework of optimal control problems governed by PDEs, with a focus on linear-quadratic elliptic problems.","type":"content","url":"/#block-i-foundations-and-linear-elliptic-optimal-control-lectures-1-6","position":15},{"hierarchy":{"lvl1":"Numerical Methods for Optimal Control","lvl4":"Topics","lvl3":"Block I: Foundations and Linear Elliptic Optimal Control (Lectures 1-6)","lvl2":"Course Topic Summary"},"type":"lvl4","url":"/#topics","position":16},{"hierarchy":{"lvl1":"Numerical Methods for Optimal Control","lvl4":"Topics","lvl3":"Block I: Foundations and Linear Elliptic Optimal Control (Lectures 1-6)","lvl2":"Course Topic Summary"},"content":"Introduction to optimal control problems: motivation, examples, and applications.\n\nAbstract formulation of PDE-constrained optimization problems.\n\nControl-to-state mapping and reduced cost functional.\n\nAdjoint equations and reduced gradients.\n\nLinear-quadratic optimal control of elliptic PDEs.\n\nDistributed and boundary controls.\n\nExistence and uniqueness of optimal controls.\n\nControl constraints and Karush-Kuhn-Tucker (KKT) conditions.\n\nConceptual introduction to numerical discretization strategies: optimize-then-discretize vs discretize-then-optimize.\n\nBy the end of this block, students understand the continuous optimality system and its analytical properties.","type":"content","url":"/#topics","position":17},{"hierarchy":{"lvl1":"Numerical Methods for Optimal Control","lvl3":"Block II: Numerical Approximation and Parabolic Optimal Control (Lectures 7-12)","lvl2":"Course Topic Summary"},"type":"lvl3","url":"/#block-ii-numerical-approximation-and-parabolic-optimal-control-lectures-7-12","position":18},{"hierarchy":{"lvl1":"Numerical Methods for Optimal Control","lvl3":"Block II: Numerical Approximation and Parabolic Optimal Control (Lectures 7-12)","lvl2":"Course Topic Summary"},"content":"This block focuses on the numerical solution of optimal control problems and extends the theory to time-dependent (parabolic) PDEs.","type":"content","url":"/#block-ii-numerical-approximation-and-parabolic-optimal-control-lectures-7-12","position":19},{"hierarchy":{"lvl1":"Numerical Methods for Optimal Control","lvl4":"Topics","lvl3":"Block II: Numerical Approximation and Parabolic Optimal Control (Lectures 7-12)","lvl2":"Course Topic Summary"},"type":"lvl4","url":"/#topics-1","position":20},{"hierarchy":{"lvl1":"Numerical Methods for Optimal Control","lvl4":"Topics","lvl3":"Block II: Numerical Approximation and Parabolic Optimal Control (Lectures 7-12)","lvl2":"Course Topic Summary"},"content":"Finite element discretization of elliptic optimal control problems.\n\nReduced vs all-at-once formulations.\n\nSaddle-point systems and block structure.\n\nIterative solvers and preconditioning strategies.\n\nNumerical treatment of control constraints.\n\nLinear-quadratic optimal control of parabolic PDEs.\n\nAdjoint equations backward in time.\n\nSpace-time discretization strategies.\n\nNumerical algorithms for time-dependent optimal control problems.\n\nComputational aspects and scalability considerations.\n\nLaboratories in this block introduce deal.II-based implementations for elliptic and parabolic problems.","type":"content","url":"/#topics-1","position":21},{"hierarchy":{"lvl1":"Numerical Methods for Optimal Control","lvl3":"Block III: Nonlinear Problems and Advanced Topics (Lectures 13-20)","lvl2":"Course Topic Summary"},"type":"lvl3","url":"/#block-iii-nonlinear-problems-and-advanced-topics-lectures-13-20","position":22},{"hierarchy":{"lvl1":"Numerical Methods for Optimal Control","lvl3":"Block III: Nonlinear Problems and Advanced Topics (Lectures 13-20)","lvl2":"Course Topic Summary"},"content":"The final block addresses nonlinear and nonsmooth optimal control problems, together with advanced numerical algorithms and applications.","type":"content","url":"/#block-iii-nonlinear-problems-and-advanced-topics-lectures-13-20","position":23},{"hierarchy":{"lvl1":"Numerical Methods for Optimal Control","lvl4":"Topics","lvl3":"Block III: Nonlinear Problems and Advanced Topics (Lectures 13-20)","lvl2":"Course Topic Summary"},"type":"lvl4","url":"/#topics-2","position":24},{"hierarchy":{"lvl1":"Numerical Methods for Optimal Control","lvl4":"Topics","lvl3":"Block III: Nonlinear Problems and Advanced Topics (Lectures 13-20)","lvl2":"Course Topic Summary"},"content":"Optimal control problems governed by semilinear PDEs.\n\nOptimization in Banach spaces.\n\nFirst-order optimality conditions for nonlinear problems.\n\nSecond-order optimality conditions and stability.\n\nNewton and Sequential Quadratic Programming (SQP) methods.\n\nPrimal-Dual Active Set (PDAS) methods and semismooth Newton methods.\n\nNonsmooth problems: box constraints, sparsity-promoting costs.\n\nSelected advanced applications (e.g., flow control, parameter identification).\n\nDiscussion of current research directions in PDE-constrained optimization.\n\nThis block prepares students to read current research literature and develop research-level numerical codes.","type":"content","url":"/#topics-2","position":25},{"hierarchy":{"lvl1":"Numerical Methods for Optimal Control","lvl3":"Overall Learning Trajectory","lvl2":"Course Topic Summary"},"type":"lvl3","url":"/#overall-learning-trajectory","position":26},{"hierarchy":{"lvl1":"Numerical Methods for Optimal Control","lvl3":"Overall Learning Trajectory","lvl2":"Course Topic Summary"},"content":"The course progresses along the following axis:\n\ncontinuous theory -> discrete formulations -> algorithms -> implementation -> applications\n\nBy the end of the course, students have:\n\nA solid theoretical understanding of PDE-constrained optimal control.\n\nPractical experience with finite element implementations in deal.II.\n\nThe ability to critically assess numerical methods and modeling choices.","type":"content","url":"/#overall-learning-trajectory","position":27},{"hierarchy":{"lvl1":"Introduction and Motivation for PDE-Constrained Optimal Control"},"type":"lvl1","url":"/lectures/lecture01","position":0},{"hierarchy":{"lvl1":"Introduction and Motivation for PDE-Constrained Optimal Control"},"content":"Slides for this lecture\n\nOpen slides","type":"content","url":"/lectures/lecture01","position":1},{"hierarchy":{"lvl1":"Introduction and Motivation for PDE-Constrained Optimal Control","lvl2":"Overview"},"type":"lvl2","url":"/lectures/lecture01#overview","position":2},{"hierarchy":{"lvl1":"Introduction and Motivation for PDE-Constrained Optimal Control","lvl2":"Overview"},"content":"This lecture introduces optimal control as an optimization problem constrained by equations.\nWe first build the finite-dimensional analogy, then move to PDE-constrained models.","type":"content","url":"/lectures/lecture01#overview","position":3},{"hierarchy":{"lvl1":"Introduction and Motivation for PDE-Constrained Optimal Control","lvl2":"1. General Optimal Control Problem"},"type":"lvl2","url":"/lectures/lecture01#id-1-general-optimal-control-problem","position":4},{"hierarchy":{"lvl1":"Introduction and Motivation for PDE-Constrained Optimal Control","lvl2":"1. General Optimal Control Problem"},"content":"Choose a control variable u and a state variable y such that(y^\\star,u^\\star)\\in\\operatorname*{argmin}_{(y,u)} J(y,u)\n\nsubject to\\mathcal{E}(y,u)=0,\\qquad u\\in\\mathcal{U}_{\\mathrm{ad}}.\n\nKey ingredients:\n\nstate equation \\mathcal{E}(y,u)=0 (ODE/PDE/algebraic)\n\nadmissible controls u\\in\\mathcal{U}_{\\mathrm{ad}}\n\ncost functional J(y,u)\n\noptional extra constraints (box constraints, state constraints, etc.)","type":"content","url":"/lectures/lecture01#id-1-general-optimal-control-problem","position":5},{"hierarchy":{"lvl1":"Introduction and Motivation for PDE-Constrained Optimal Control","lvl2":"2. Forward Problem vs Control Problem"},"type":"lvl2","url":"/lectures/lecture01#id-2-forward-problem-vs-control-problem","position":6},{"hierarchy":{"lvl1":"Introduction and Motivation for PDE-Constrained Optimal Control","lvl2":"2. Forward Problem vs Control Problem"},"content":"Forward problem:\n\ndata are fixed\n\nsolve once for y\n\nOptimal control:\n\nu is unknown\n\nsolve the state equation repeatedly inside optimization\n\nKey point\n\nIn optimal control, the PDE is a constraint, not the objective.","type":"content","url":"/lectures/lecture01#id-2-forward-problem-vs-control-problem","position":7},{"hierarchy":{"lvl1":"Introduction and Motivation for PDE-Constrained Optimal Control","lvl2":"3. Finite-Dimensional Setting (Simultaneous vs Reduced)"},"type":"lvl2","url":"/lectures/lecture01#id-3-finite-dimensional-setting-simultaneous-vs-reduced","position":8},{"hierarchy":{"lvl1":"Introduction and Motivation for PDE-Constrained Optimal Control","lvl2":"3. Finite-Dimensional Setting (Simultaneous vs Reduced)"},"content":"Consider\\min_{y\\in\\mathbb{R}^n,\\,u\\in\\mathbb{R}^m} J(y,u)\n\\quad\\text{s.t.}\\quad Ay=Bu,\n\nwith A\\in\\mathbb{R}^{n\\times n} invertible.","type":"content","url":"/lectures/lecture01#id-3-finite-dimensional-setting-simultaneous-vs-reduced","position":9},{"hierarchy":{"lvl1":"Introduction and Motivation for PDE-Constrained Optimal Control","lvl3":"3.1 Simultaneous formulation","lvl2":"3. Finite-Dimensional Setting (Simultaneous vs Reduced)"},"type":"lvl3","url":"/lectures/lecture01#id-3-1-simultaneous-formulation","position":10},{"hierarchy":{"lvl1":"Introduction and Motivation for PDE-Constrained Optimal Control","lvl3":"3.1 Simultaneous formulation","lvl2":"3. Finite-Dimensional Setting (Simultaneous vs Reduced)"},"content":"Optimize in (y,u) and enforce Ay=Bu explicitly.","type":"content","url":"/lectures/lecture01#id-3-1-simultaneous-formulation","position":11},{"hierarchy":{"lvl1":"Introduction and Motivation for PDE-Constrained Optimal Control","lvl3":"3.2 Reduced formulation","lvl2":"3. Finite-Dimensional Setting (Simultaneous vs Reduced)"},"type":"lvl3","url":"/lectures/lecture01#id-3-2-reduced-formulation","position":12},{"hierarchy":{"lvl1":"Introduction and Motivation for PDE-Constrained Optimal Control","lvl3":"3.2 Reduced formulation","lvl2":"3. Finite-Dimensional Setting (Simultaneous vs Reduced)"},"content":"Since A is invertible,y=A^{-1}Bu=:S(u),\n\nwhere S is the control-to-state operator.\nThen definef(u):=J(S(u),u),\n\nand solve\\min_{u\\in\\mathcal{U}_{\\mathrm{ad}}} f(u).\n\nThis reduces a finite-dimensional control problem to a standard finite-dimensional optimization problem.","type":"content","url":"/lectures/lecture01#id-3-2-reduced-formulation","position":13},{"hierarchy":{"lvl1":"Introduction and Motivation for PDE-Constrained Optimal Control","lvl2":"4. Existence in Finite Dimensions"},"type":"lvl2","url":"/lectures/lecture01#id-4-existence-in-finite-dimensions","position":14},{"hierarchy":{"lvl1":"Introduction and Motivation for PDE-Constrained Optimal Control","lvl2":"4. Existence in Finite Dimensions"},"content":"A standard existence result for the reduced problem:\n\nIf\n\nf is lower semicontinuous and bounded from below,\n\none level set L_t:=\\{u\\in\\mathcal{U}_{\\mathrm{ad}}:f(u)\\le t\\} is nonempty, closed, and bounded,\n\nthen a minimizer exists.\n\nReason: in finite dimensions, closed and bounded sets are compact (Weierstrass theorem).\n\nImportant warning\n\nIn infinite-dimensional spaces, closed and bounded sets are generally not compact.\nThis is one of the main analytical difficulties for PDE-constrained optimization.","type":"content","url":"/lectures/lecture01#id-4-existence-in-finite-dimensions","position":15},{"hierarchy":{"lvl1":"Introduction and Motivation for PDE-Constrained Optimal Control","lvl2":"5. Unconstrained First/Second-Order Conditions"},"type":"lvl2","url":"/lectures/lecture01#id-5-unconstrained-first-second-order-conditions","position":16},{"hierarchy":{"lvl1":"Introduction and Motivation for PDE-Constrained Optimal Control","lvl2":"5. Unconstrained First/Second-Order Conditions"},"content":"For convex differentiable f on a convex set K:\\nabla f(\\bar u)\\cdot (u-\\bar u)\\ge 0\\quad\\forall u\\in K\n\nis the first-order optimality condition.\n\nSpecial case (interior point):\\nabla f(\\bar u)=0.\n\nIf f\\in C^2 and \\bar u is a local minimizer:\n\n\\nabla f(\\bar u)=0\n\nD^2 f(\\bar u) is positive semidefinite\n\nIf moreover D^2 f(\\bar u) is positive definite, then \\bar u is a strict local minimizer.","type":"content","url":"/lectures/lecture01#id-5-unconstrained-first-second-order-conditions","position":17},{"hierarchy":{"lvl1":"Introduction and Motivation for PDE-Constrained Optimal Control","lvl2":"6. Constrained minimization (2D Example)"},"type":"lvl2","url":"/lectures/lecture01#id-6-constrained-minimization-2d-example","position":18},{"hierarchy":{"lvl1":"Introduction and Motivation for PDE-Constrained Optimal Control","lvl2":"6. Constrained minimization (2D Example)"},"content":"Let\\mathcal{U}_{\\mathrm{ad}}=\\mathbb{R}^2,\\qquad\nf(u)=\\frac12 u^T A u,\\qquad\n\\varphi(u)=Bu-g=0,\n\nwithA\\in\\mathbb{R}^{2\\times 2}\\text{ SPD},\\quad B\\in\\mathbb{R}^{1\\times 2},\\quad g\\in\\mathbb{R}.\n\nAt an optimal feasible point, \\nabla f is orthogonal to the feasible tangent direction,\nso it must be parallel to \\nabla\\varphi:\\nabla f(\\bar u)=(\\nabla\\varphi(\\bar u))^T\\lambda.\n\nEquivalent first-order form:\\nabla f(\\bar u)-(\\nabla\\varphi(\\bar u))^T\\lambda=0,\n\\qquad\n\\varphi(\\bar u)=0.\n\nDefine the Lagrangian\\mathcal{L}(u,\\lambda)=f(u)-\\varphi(u)\\cdot\\lambda.\n\nStationarity gives\\frac{\\partial\\mathcal{L}}{\\partial u}=0,\n\\qquad\n\\frac{\\partial\\mathcal{L}}{\\partial \\lambda}=0.\n\nFor this quadratic/affine case:\\nabla_u\\mathcal{L}=Au-B^T\\lambda=0,\n\\qquad\n\\nabla_\\lambda\\mathcal{L}=-Bu+g=0,\n\nwhich is the KKT linear system\\begin{pmatrix}A & -B^T \\\\\\ -B & 0\\end{pmatrix}\\begin{pmatrix}u \\\\\\ \\lambda\\end{pmatrix}=\\begin{pmatrix}0 \\\\\\ -g\\end{pmatrix}.\n\n ","type":"content","url":"/lectures/lecture01#id-6-constrained-minimization-2d-example","position":19},{"hierarchy":{"lvl1":"Introduction and Motivation for PDE-Constrained Optimal Control","lvl2":"7. From Finite to Infinite Dimensions"},"type":"lvl2","url":"/lectures/lecture01#id-7-from-finite-to-infinite-dimensions","position":20},{"hierarchy":{"lvl1":"Introduction and Motivation for PDE-Constrained Optimal Control","lvl2":"7. From Finite to Infinite Dimensions"},"content":"For PDE-constrained control, state/control live in function spaces (typically Hilbert spaces):\n\nstate space Y (e.g. Sobolev spaces)\n\ncontrol space U\n\nPDE operator \\mathcal{E}(y,u)=0\n\nTypical difficulties:\n\nnon-compactness in infinite dimension\n\nweak vs strong convergence issues\n\ndifferentiability in Banach/Hilbert spaces\n\nadjoint equations for gradient computation","type":"content","url":"/lectures/lecture01#id-7-from-finite-to-infinite-dimensions","position":21},{"hierarchy":{"lvl1":"Introduction and Motivation for PDE-Constrained Optimal Control","lvl2":"8. Prototypical PDE-Constrained Models"},"type":"lvl2","url":"/lectures/lecture01#id-8-prototypical-pde-constrained-models","position":22},{"hierarchy":{"lvl1":"Introduction and Motivation for PDE-Constrained Optimal Control","lvl2":"8. Prototypical PDE-Constrained Models"},"content":"","type":"content","url":"/lectures/lecture01#id-8-prototypical-pde-constrained-models","position":23},{"hierarchy":{"lvl1":"Introduction and Motivation for PDE-Constrained Optimal Control","lvl3":"8.1 Elliptic distributed control","lvl2":"8. Prototypical PDE-Constrained Models"},"type":"lvl3","url":"/lectures/lecture01#id-8-1-elliptic-distributed-control","position":24},{"hierarchy":{"lvl1":"Introduction and Motivation for PDE-Constrained Optimal Control","lvl3":"8.1 Elliptic distributed control","lvl2":"8. Prototypical PDE-Constrained Models"},"content":"\\min_{(y,u)}\n\\frac12\\|y-y_d\\|_{L^2(\\Omega)}^2\n+\\frac\\alpha2\\|u\\|_{L^2(\\Omega)}^2\n\nsubject to-\\Delta y=u\\text{ in }\\Omega,\n\\qquad y=0\\text{ on }\\partial\\Omega,\n\\qquad u\\in U_{\\mathrm{ad}}.","type":"content","url":"/lectures/lecture01#id-8-1-elliptic-distributed-control","position":25},{"hierarchy":{"lvl1":"Introduction and Motivation for PDE-Constrained Optimal Control","lvl3":"8.2 Parabolic control","lvl2":"8. Prototypical PDE-Constrained Models"},"type":"lvl3","url":"/lectures/lecture01#id-8-2-parabolic-control","position":26},{"hierarchy":{"lvl1":"Introduction and Motivation for PDE-Constrained Optimal Control","lvl3":"8.2 Parabolic control","lvl2":"8. Prototypical PDE-Constrained Models"},"content":"\\partial_t y-\\Delta y=u\\text{ in }Q,\n\\qquad y(\\cdot,0)=y_0,\n\nwith tracking over space-time and Tikhonov regularization.","type":"content","url":"/lectures/lecture01#id-8-2-parabolic-control","position":27},{"hierarchy":{"lvl1":"Introduction and Motivation for PDE-Constrained Optimal Control","lvl3":"8.3 Flow and inverse problems","lvl2":"8. Prototypical PDE-Constrained Models"},"type":"lvl3","url":"/lectures/lecture01#id-8-3-flow-and-inverse-problems","position":28},{"hierarchy":{"lvl1":"Introduction and Motivation for PDE-Constrained Optimal Control","lvl3":"8.3 Flow and inverse problems","lvl2":"8. Prototypical PDE-Constrained Models"},"content":"Navier-Stokes control (nonlinear constraints)\n\nparameter estimation/data assimilation","type":"content","url":"/lectures/lecture01#id-8-3-flow-and-inverse-problems","position":29},{"hierarchy":{"lvl1":"Introduction and Motivation for PDE-Constrained Optimal Control","lvl2":"9. Control Constraints"},"type":"lvl2","url":"/lectures/lecture01#id-9-control-constraints","position":30},{"hierarchy":{"lvl1":"Introduction and Motivation for PDE-Constrained Optimal Control","lvl2":"9. Control Constraints"},"content":"Common box constraints:u_{\\min}\\le u\\le u_{\\max}.\n\nThey lead to variational inequalities and KKT systems in function spaces.","type":"content","url":"/lectures/lecture01#id-9-control-constraints","position":31},{"hierarchy":{"lvl1":"Introduction and Motivation for PDE-Constrained Optimal Control","lvl2":"References for This Lecture"},"type":"lvl2","url":"/lectures/lecture01#references-for-this-lecture","position":32},{"hierarchy":{"lvl1":"Introduction and Motivation for PDE-Constrained Optimal Control","lvl2":"References for This Lecture"},"content":"F. Tr√∂ltzsch, Optimal Control of Partial Differential Equations, Chapter 1\n\nA. Manzoni, A. Quarteroni, S. Salsa, Optimal Control of PDEs, Chapter 1\n\nJ. C. De los Reyes, Numerical PDE-Constrained Optimization, Section 1 FOOTER START \n\nüé¨ View Slides\n\nOpen slides in full screen for the best viewing experience. FOOTER END ","type":"content","url":"/lectures/lecture01#references-for-this-lecture","position":33},{"hierarchy":{"lvl1":"Introduction & Motivation"},"type":"lvl1","url":"/slides/slides01","position":0},{"hierarchy":{"lvl1":"Introduction & Motivation"},"content":"Numerical Methods for Optimal Control (NMOPT)\n\nLuca Heltai (\n\nluca‚Äã.heltai@unipi‚Äã.it)","type":"content","url":"/slides/slides01","position":1},{"hierarchy":{"lvl1":"Introduction & Motivation","lvl2":"What Is Optimal Control?"},"type":"lvl2","url":"/slides/slides01#what-is-optimal-control","position":2},{"hierarchy":{"lvl1":"Introduction & Motivation","lvl2":"What Is Optimal Control?"},"content":"Choose a control u to minimize a cost J(y,u).\n\nThe state y is constrained by a model (often a PDE).\n\nOptimization + differential constraints = PDE-constrained optimization.","type":"content","url":"/slides/slides01#what-is-optimal-control","position":3},{"hierarchy":{"lvl1":"Introduction & Motivation","lvl2":"Abstract Formulation"},"type":"lvl2","url":"/slides/slides01#abstract-formulation","position":4},{"hierarchy":{"lvl1":"Introduction & Motivation","lvl2":"Abstract Formulation"},"content":"Minimize\\min_{y,u} \\; J(y,u)\n\nsubject to the state equation\\mathcal{E}(y,u) = 0.\n\nTypical pieces:\n\nstate equation (PDE)\n\nadmissible controls u \\in \\mathcal{U}_{\\mathrm{ad}}\n\nconstraints (box constraints, etc.)","type":"content","url":"/slides/slides01#abstract-formulation","position":5},{"hierarchy":{"lvl1":"Introduction & Motivation","lvl2":"Forward vs Optimal Control"},"type":"lvl2","url":"/slides/slides01#forward-vs-optimal-control","position":6},{"hierarchy":{"lvl1":"Introduction & Motivation","lvl2":"Forward vs Optimal Control"},"content":"Forward (direct) problem:\n\ninput data given\n\nsolve PDE once to compute y\n\nOptimal control:\n\ncontrol u unknown\n\nPDE is solved repeatedly while optimizing J\n\nKey point: the PDE is a constraint, not the objective.","type":"content","url":"/slides/slides01#forward-vs-optimal-control","position":7},{"hierarchy":{"lvl1":"Introduction & Motivation","lvl2":"Reduced Formulation"},"type":"lvl2","url":"/slides/slides01#reduced-formulation","position":8},{"hierarchy":{"lvl1":"Introduction & Motivation","lvl2":"Reduced Formulation"},"content":"If the state equation defines a control-to-state map S:y = S(u),\n\nthen define the reduced costf(u) := J(S(u),u),\n\nand solve\\min_{u} f(u).\n\nWhy it matters:\n\nseparates ‚ÄúPDE solve‚Äù from ‚Äúoptimization step‚Äù\n\nmakes gradients/adjoins systematic","type":"content","url":"/slides/slides01#reduced-formulation","position":9},{"hierarchy":{"lvl1":"Introduction & Motivation","lvl2":"Tiny Example Notebook"},"type":"lvl2","url":"/slides/slides01#tiny-example-notebook","position":10},{"hierarchy":{"lvl1":"Introduction & Motivation","lvl2":"Tiny Example Notebook"},"content":"Finite-dimensional LQ reduction + a 1D slice plot.\n\nGenerates figures used in these slides.\n\nFile: codes/lecture01/finite_dim_analogy.ipynb","type":"content","url":"/slides/slides01#tiny-example-notebook","position":11},{"hierarchy":{"lvl1":"Introduction & Motivation","lvl2":"Example: Reduced Cost Shape"},"type":"lvl2","url":"/slides/slides01#example-reduced-cost-shape","position":12},{"hierarchy":{"lvl1":"Introduction & Motivation","lvl2":"Example: Reduced Cost Shape"},"content":"","type":"content","url":"/slides/slides01#example-reduced-cost-shape","position":13},{"hierarchy":{"lvl1":"Introduction & Motivation","lvl2":"Control-to-State Pipeline"},"type":"lvl2","url":"/slides/slides01#control-to-state-pipeline","position":14},{"hierarchy":{"lvl1":"Introduction & Motivation","lvl2":"Control-to-State Pipeline"},"content":"","type":"content","url":"/slides/slides01#control-to-state-pipeline","position":15},{"hierarchy":{"lvl1":"Introduction & Motivation","lvl2":"A Finite-Dimensional Analogy"},"type":"lvl2","url":"/slides/slides01#a-finite-dimensional-analogy","position":16},{"hierarchy":{"lvl1":"Introduction & Motivation","lvl2":"A Finite-Dimensional Analogy"},"content":"Given A y = B u with invertible A:y = A^{-1} B u =: S u\n\nReduced problem:\\min_u f(u) := J(Su,u).\n\nThis is the template we will reuse in infinite dimensions.","type":"content","url":"/slides/slides01#a-finite-dimensional-analogy","position":17},{"hierarchy":{"lvl1":"Introduction & Motivation","lvl2":"Constrained Minimization in 2D"},"type":"lvl2","url":"/slides/slides01#constrained-minimization-in-2d","position":18},{"hierarchy":{"lvl1":"Introduction & Motivation","lvl2":"Constrained Minimization in 2D"},"content":"Consider\\min_{u\\in\\mathbb{R}^2} f(u)=\\frac12 u^T A u\n\\quad \\text{s.t.} \\quad\n\\varphi(u)=Bu-g=0,\n\nwith A SPD, B\\in\\mathbb{R}^{1\\times 2}.\n\nAt an optimum:\\nabla f(\\bar u)-(\\nabla\\varphi(\\bar u))^T\\lambda=0,\n\\qquad\n\\varphi(\\bar u)=0.","type":"content","url":"/slides/slides01#constrained-minimization-in-2d","position":19},{"hierarchy":{"lvl1":"Introduction & Motivation","lvl2":"Lagrangian and KKT System"},"type":"lvl2","url":"/slides/slides01#lagrangian-and-kkt-system","position":20},{"hierarchy":{"lvl1":"Introduction & Motivation","lvl2":"Lagrangian and KKT System"},"content":"Lagrangian:\\mathcal{L}(u,\\lambda)=f(u)-\\varphi(u)\\cdot \\lambda\n\nStationarity:\\nabla_u\\mathcal{L}=Au-B^T\\lambda=0,\\qquad\n\\nabla_\\lambda\\mathcal{L}=-Bu+g=0.\n\nEquivalent saddle-point linear system\\begin{pmatrix}A & -B^T \\\\\\ -B & 0\\end{pmatrix}\\begin{pmatrix}u \\\\\\ \\lambda\\end{pmatrix}=\\begin{pmatrix}0 \\\\\\ -g\\end{pmatrix}","type":"content","url":"/slides/slides01#lagrangian-and-kkt-system","position":21},{"hierarchy":{"lvl1":"Introduction & Motivation","lvl2":"2D Constrained Geometry"},"type":"lvl2","url":"/slides/slides01#id-2d-constrained-geometry","position":22},{"hierarchy":{"lvl1":"Introduction & Motivation","lvl2":"2D Constrained Geometry"},"content":"","type":"content","url":"/slides/slides01#id-2d-constrained-geometry","position":23},{"hierarchy":{"lvl1":"Introduction & Motivation","lvl2":"Objective on the Feasible Line"},"type":"lvl2","url":"/slides/slides01#objective-on-the-feasible-line","position":24},{"hierarchy":{"lvl1":"Introduction & Motivation","lvl2":"Objective on the Feasible Line"},"content":"","type":"content","url":"/slides/slides01#objective-on-the-feasible-line","position":25},{"hierarchy":{"lvl1":"Introduction & Motivation","lvl2":"When PDEs Show Up"},"type":"lvl2","url":"/slides/slides01#when-pdes-show-up","position":26},{"hierarchy":{"lvl1":"Introduction & Motivation","lvl2":"When PDEs Show Up"},"content":"States: temperature, displacement, velocity, concentration, ...\n\nControls:\n\ndistributed sources\n\nboundary inputs\n\ninitial conditions\n\nparameters / coefficients","type":"content","url":"/slides/slides01#when-pdes-show-up","position":27},{"hierarchy":{"lvl1":"Introduction & Motivation","lvl2":"Typical Examples"},"type":"lvl2","url":"/slides/slides01#typical-examples","position":28},{"hierarchy":{"lvl1":"Introduction & Motivation","lvl2":"Typical Examples"},"content":"Elliptic: stationary heating / diffusion\n\nParabolic: time-dependent heating\n\nNonlinear: Navier-Stokes flow control\n\nInverse problems: parameter estimation / data assimilation","type":"content","url":"/slides/slides01#typical-examples","position":29},{"hierarchy":{"lvl1":"Introduction & Motivation","lvl2":"Constraints"},"type":"lvl2","url":"/slides/slides01#constraints","position":30},{"hierarchy":{"lvl1":"Introduction & Motivation","lvl2":"Constraints"},"content":"Common: box constraints on the controlu_{\\min} \\le u \\le u_{\\max}.\n\nLeads to:\n\nvariational inequalities\n\nKKT conditions\n\nactive-set / projection-type algorithms","type":"content","url":"/slides/slides01#constraints","position":31}]}